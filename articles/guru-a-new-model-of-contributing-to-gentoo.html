<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta charset="utf-8"/>
<meta name="generator" content="Docutils 0.16: http://docutils.sourceforge.net/" />
<title>GURU: a new model of contributing to Gentoo (WIP)</title>
<meta name="author" content="Michał Górny" />
<meta name="dcterms.date" content="2019-02-08" />
<meta name="dcterms.rights" content="https://creativecommons.org/licenses/by/3.0/" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/">
<style type="text/css">

/* Minimal style sheet for the HTML output of Docutils.                    */
/*                                                                         */
/* :Author: Günter Milde, based on html4css1.css by David Goodger          */
/* :Id: $Id: minimal.css 8397 2019-09-20 11:09:34Z milde $               */
/* :Copyright: © 2015 Günter Milde.                                        */
/* :License: Released under the terms of the `2-Clause BSD license`_,      */
/*    in short:                                                            */
/*                                                                         */
/*    Copying and distribution of this file, with or without modification, */
/*    are permitted in any medium without royalty provided the copyright   */
/*    notice and this notice are preserved.                                */
/*                                                                         */
/*    This file is offered as-is, without any warranty.                    */
/*                                                                         */
/* .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause     */

/* This CSS2.1_ stylesheet defines rules for Docutils elements without    */
/* HTML equivalent. It is required to make the document semantic visible. */
/*                                                                        */
/* .. _CSS2.1: http://www.w3.org/TR/CSS2                                  */
/* .. _validates: http://jigsaw.w3.org/css-validator/validator$link       */

/* alignment of text and inline objects inside block objects*/
.align-left   { text-align: left; }
.align-right  { text-align: right; }
.align-center { clear: both; text-align: center; }
.align-top    { vertical-align: top; }
.align-middle { vertical-align: middle; }
.align-bottom { vertical-align: bottom; }

/* titles */
h1.title, p.subtitle {
  text-align: center;
}
p.topic-title,
p.sidebar-title,
p.rubric,
p.admonition-title,
p.system-message-title {
  font-weight: bold;
}
h1 + p.subtitle,
h1 + p.section-subtitle {
  font-size: 1.6em;
}
h2 + p.section-subtitle { font-size: 1.28em; }
p.subtitle,
p.section-subtitle,
p.sidebar-subtitle {
  font-weight: bold;
  margin-top: -0.5em;
}
p.sidebar-title,
p.rubric {
  font-size: larger;
}
p.rubric { color: maroon; }
a.toc-backref {
  color: black;
  text-decoration: none; }

/* Warnings, Errors */
div.caution p.admonition-title,
div.attention p.admonition-title,
div.danger p.admonition-title,
div.error p.admonition-title,
div.warning p.admonition-title,
div.system-messages h1,
div.error,
span.problematic,
p.system-message-title {
  color: red;
}

/* inline literals */
span.docutils.literal {
  font-family: monospace;
  white-space: pre-wrap;
}
/* do not wraph at hyphens and similar: */
.literal > span.pre { white-space: nowrap; }

/* Lists */

/* compact and simple lists: no margin between items */
.simple  li, .compact li,
.simple  ul, .compact ul,
.simple  ol, .compact ol,
.simple > li p, .compact > li p,
dl.simple > dd, dl.compact > dd {
  margin-top: 0;
  margin-bottom: 0;
}

/* Table of Contents */
div.topic.contents { margin: 0.5em 0; }
div.topic.contents ul {
  list-style-type: none;
  padding-left: 1.5em;
}

/* Enumerated Lists */
ol.arabic     { list-style: decimal }
ol.loweralpha { list-style: lower-alpha }
ol.upperalpha { list-style: upper-alpha }
ol.lowerroman { list-style: lower-roman }
ol.upperroman { list-style: upper-roman }

dt span.classifier { font-style: italic }
dt span.classifier:before {
  font-style: normal;
  margin: 0.5em;
  content: ":";
}

/* Field Lists and drivatives */
/* bold field name, content starts on the same line */
dl.field-list > dt,
dl.option-list > dt,
dl.docinfo > dt,
dl.footnote > dt,
dl.citation > dt {
  font-weight: bold;
  clear: left;
  float: left;
  margin: 0;
  padding: 0;
  padding-right: 0.5em;
}
/* Offset for field content (corresponds to the --field-name-limit option) */
dl.field-list > dd,
dl.option-list > dd,
dl.docinfo > dd {
  margin-left:  9em; /* ca. 14 chars in the test examples */
}
/* start field-body on a new line after long field names */
dl.field-list > dd > *:first-child,
dl.option-list > dd > *:first-child
{
  display: inline-block;
  width: 100%;
  margin: 0;
}
/* field names followed by a colon */
dl.field-list > dt:after,
dl.docinfo > dt:after {
  content: ":";
}

/* Bibliographic Fields (docinfo) */
pre.address { font: inherit; }
dd.authors > p { margin: 0; }

/* Option Lists */
dl.option-list { margin-left: 1.5em; }
dl.option-list > dt { font-weight: normal; }
span.option { white-space: nowrap; }

/* Footnotes and Citations  */
dl.footnote.superscript > dd {margin-left: 1em; }
dl.footnote.brackets > dd {margin-left: 2em; }
dl > dt.label { font-weight: normal; }
a.footnote-reference.brackets:before,
dt.label > span.brackets:before { content: "["; }
a.footnote-reference.brackets:after,
dt.label > span.brackets:after { content: "]"; }
a.footnote-reference.superscript,
dl.footnote.superscript > dt.label {
  vertical-align: super;
  font-size: smaller;
}
dt.label > span.fn-backref { margin-left: 0.2em; }
dt.label > span.fn-backref > a { font-style: italic; }

/* Line Blocks */
div.line-block { display: block; }
div.line-block div.line-block {
  margin-top: 0;
  margin-bottom: 0;
  margin-left: 40px;
}

/* Figures, Images, and Tables */
.figure.align-left,
figure.align-left,
img.align-left,
object.align-left,
table.align-left {
  margin-right: auto;
}
.figure.align-center,
figure.align-center,
img.align-center,
object.align-center,
table.align-center {
  margin-left: auto;
  margin-right: auto;
}
.figure.align-right,
figure.align-right,
img.align-right,
object.align-right,
table.align-right {
  margin-left: auto;
}
.figure.align-center, .figure.align-right,
figure.align-center, figure.align-right,
img.align-center, img.align-right,
object.align-center, object.align-right {
  display: block;
}
/* reset inner alignment in figures and tables */
.figure.align-left, .figure.align-right,
figure.align-left, figure.align-right,
table.align-left, table.align-center, table.align-right {
  text-align: inherit;
}

/* Admonitions and System Messages */
div.admonition,
div.system-message,
div.sidebar,
aside.sidebar {
  margin: 1em 1.5em;
  border: medium outset;
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  padding-right: 1em;
  padding-left: 1em;
}

/* Sidebar */
div.sidebar,
aside.sidebar {
  width: 30%;
  max-width: 26em;
  float: right;
  clear: right;
}

/* Text Blocks */
blockquote,
div.topic,
pre.literal-block,
pre.doctest-block,
pre.math,
pre.code {
  margin-left: 1.5em;
  margin-right: 1.5em;
}
pre.code .ln { color: gray; } /* line numbers */

/* Tables */
table { border-collapse: collapse; }
td, th {
  border-style: solid;
  border-color: silver;
  padding: 0 1ex;
  border-width: thin;
}
td > p:first-child, th > p:first-child { margin-top: 0; }
td > p, th > p { margin-bottom: 0; }

table > caption {
  text-align: left;
  margin-bottom: 0.25em
}

table.borderless td, table.borderless th {
  border: 0;
  padding: 0;
  padding-right: 0.5em /* separate table cells */
}

/* Document Header and Footer */
/* div.header,				      */
/* header { border-bottom: 1px solid black; } */
/* div.footer,				      */
/* footer { border-top: 1px solid black; }    */

/* new HTML5 block elements: set display for older browsers */
header, section, footer, aside, nav, main, article, figure {
  display: block;
}

</style>
<style type="text/css">

/* CSS31_ style sheet for the output of Docutils HTML writers.             */
/* Rules for easy reading and pre-defined style variants.		   */
/*                                                                         */
/* :Author: Günter Milde, based on html4css1.css by David Goodger          */
/* :Id: $Id: plain.css 8397 2019-09-20 11:09:34Z milde $               */
/* :Copyright: © 2015 Günter Milde.                                        */
/* :License: Released under the terms of the `2-Clause BSD license`_,      */
/*    in short:                                                            */
/*                                                                         */
/*    Copying and distribution of this file, with or without modification, */
/*    are permitted in any medium without royalty provided the copyright   */
/*    notice and this notice are preserved.                                */
/*    	     	      	     	 					   */
/*    This file is offered as-is, without any warranty.                    */
/*                                                                         */
/* .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause     */
/* .. _CSS3: http://www.w3.org/TR/CSS3		        		   */


/* Document Structure */
/* ****************** */

/* "page layout" */
body {
  margin: 0;
  background-color: #dbdbdb;
}
div.document,
main {
  line-height:1.3;
  counter-reset: table;
  /* counter-reset: figure; */
  /* avoid long lines --> better reading */
  /* OTOH: lines should not be too short because of missing hyphenation, */
  max-width: 50em;
  padding: 1px 2%; /* 1px on top avoids grey bar above title (mozilla) */
  margin: auto;
  background-color: white;
}

/* Sections */

/* Transitions */

hr.docutils {
  width: 80%;
  margin-top: 1em;
  margin-bottom: 1em;
  clear: both;
}

/* Paragraphs */
/* ========== */

/* vertical space (parskip) */
p, ol, ul, dl,
div.line-block,
div.topic,
table {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}
p:first-child { margin-top: 0; }
/* (:last-child is new in CSS 3) */
p:last-child  { margin-bottom: 0; }

h1, h2, h3, h4, h5, h6,
dl > dd {
  margin-bottom: 0.5em;
}

/* Lists */
/* ===== */

/* Definition Lists */

/* lists nested in definition lists */
/* (:only-child is new in CSS 3) */
dd > ul:only-child, dd > ol:only-child { padding-left: 1em; }

/* Description Lists */
/* styled like in most dictionaries, encyclopedias etc. */
dl.description > dt {
  font-weight: bold;
  clear: left;
  float: left;
  margin: 0;
  padding: 0;
  padding-right: 0.5em;
}

/* Field Lists */

/* example for custom field-name width */
dl.field-list.narrow > dd {
  margin-left: 5em;
}
/* run-in: start field-body on same line after long field names */
dl.field-list.run-in > dd p {
  display: block;
}

/* Bibliographic Fields */

/* generally, bibliographic fields use special definition list dl.docinfo */
/* but dedication and abstract are placed into "topic" divs */
div.abstract p.topic-title {
  text-align: center;
}
div.dedication {
  margin: 2em 5em;
  text-align: center;
  font-style: italic;
}
div.dedication p.topic-title {
  font-style: normal;
}

/* Citations */
dl.citation dt.label {
  font-weight: bold;
}
span.fn-backref {
  font-weight: normal;
}

/* Text Blocks */
/* =========== */

/* Literal Blocks */

pre.literal-block,
pre.doctest-block,
pre.math,
pre.code {
  font-family: monospace;
}

/* Block Quotes */

blockquote > table,
div.topic > table {
  margin-top: 0;
  margin-bottom: 0;
}
blockquote p.attribution,
div.topic p.attribution {
  text-align: right;
  margin-left: 20%;
}

/* Tables */
/* ====== */

/* th { vertical-align: bottom; } */

table tr { text-align: left; }

/* "booktabs" style (no vertical lines) */
table.booktabs {
  border: 0;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.booktabs * {
  border: 0;
}
table.booktabs th {
  border-bottom: thin solid;
}

/* numbered tables (counter defined in div.document) */
table.numbered > caption:before {
  counter-increment: table;
  content: "Table " counter(table) ": ";
  font-weight: bold;
}

/* Explicit Markup Blocks */
/* ====================== */

/* Footnotes and Citations */
/* ----------------------- */

/* line on the left */
dl.footnote {
  padding-left: 1ex;
  border-left: solid;
  border-left-width: thin;
}

/* Directives */
/* ---------- */

/* Body Elements */
/* ~~~~~~~~~~~~~ */

/* Images and Figures */

/* let content flow to the side of aligned images and figures */
.figure.align-left,
figure.align-left,
img.align-left,
object.align-left {
  display: block;
  clear: left;
  float: left;
  margin-right: 1em;
}
.figure.align-right,
figure.align-right,
img.align-right,
object.align-right {
  display: block;
  clear: right;
  float: right;
  margin-left: 1em;
}
/* Stop floating sidebars, images and figures at section level 1,2,3 */
h1, h2, h3 { clear: both; }

/* Sidebar */

/* Move right. In a layout with fixed margins, */
/* it can be moved into the margin.   	       */
div.sidebar,
aside.sidebar {
  width: 30%;
  max-width: 26em;
  margin-left: 1em;
  margin-right: -2%;
  background-color: #ffffee;
}

/* Code */

pre.code { padding: 0.7ex }
pre.code, code { background-color: #eeeeee }
pre.code .ln { color: gray; } /* line numbers */
/* basic highlighting: for a complete scheme, see */
/* http://docutils.sourceforge.net/sandbox/stylesheets/ */
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

/* Math */
/* styled separately (see math.css for math-output=HTML) */

/* Epigraph           */
/* Highlights         */
/* Pull-Quote         */
/* Compound Paragraph */
/* Container          */

/* can be styled in a custom stylesheet */

/* Document Header and Footer */

footer, header,
div.footer, div.header {
  font-size: smaller;
  clear: both;
  padding: 0.5em 2%;
  background-color: #ebebee;
  border: none;
}

/* Inline Markup */
/* ============= */

/* Emphasis           */
/*   em               */
/* Strong Emphasis    */
/*   strong	      */
/* Interpreted Text   */
/*   span.interpreted */
/* Title Reference    */
/*   cite	      */

/* Inline Literals                                          */
/* possible values: normal, nowrap, pre, pre-wrap, pre-line */
/*   span.docutils.literal { white-space: pre-wrap; }       */

/* Hyperlink References */
a { text-decoration: none; }

/* External Targets       */
/*   span.target.external */
/* Internal Targets  	  */
/*   span.target.internal */
/* Footnote References    */
/*   a.footnote-reference */
/* Citation References    */
/*   a.citation-reference */

</style>
</head>
<body>
<div class="document" id="guru-a-new-model-of-contributing-to-gentoo-wip">
<h1 class="title">GURU: a new model of contributing to Gentoo (WIP)</h1>
<dl class="docinfo simple">
<dt class="author">Author</dt>
<dd class="author"><p>Michał Górny</p></dd>
<dt class="date">Date</dt>
<dd class="date">2019-02-08</dd>
<dt class="version">Version</dt>
<dd class="version">0.1</dd>
<dt class="copyright">Copyright</dt>
<dd class="copyright"><a class="reference external" href="https://creativecommons.org/licenses/by/3.0/">https://creativecommons.org/licenses/by/3.0/</a></dd>
</dl>
<img alt="GURU logo" class="align-center" src="guru-a-new-model-of-contributing-to-gentoo/guru.svg" />
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#preface" id="id7">Preface</a></p></li>
<li><p><a class="reference internal" href="#existing-and-historical-contribution-models" id="id8">Existing and historical contribution models</a></p>
<ul>
<li><p><a class="reference internal" href="#bugzilla-and-e-mail-submissions" id="id9">Bugzilla and e-mail submissions</a></p></li>
<li><p><a class="reference internal" href="#the-sunrise-project-historical" id="id10">The Sunrise project (historical)</a></p></li>
<li><p><a class="reference internal" href="#proxied-maintainers" id="id11">Proxied maintainers</a></p></li>
<li><p><a class="reference internal" href="#user-repositories-overlays" id="id12">User repositories (overlays)</a></p></li>
<li><p><a class="reference internal" href="#project-repositories" id="id13">Project repositories</a></p></li>
<li><p><a class="reference internal" href="#effort-reach-comparison" id="id14">Effort-reach comparison</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#the-proposed-guru-model" id="id15">The proposed GURU model</a></p>
<ul>
<li><p><a class="reference internal" href="#repository-layout" id="id16">Repository layout</a></p></li>
<li><p><a class="reference internal" href="#user-access-and-workflow" id="id17">User access and workflow</a></p>
<ul>
<li><p><a class="reference internal" href="#classes-of-users" id="id18">Classes of users</a></p></li>
<li><p><a class="reference internal" href="#commit-reviews-and-merging" id="id19">Commit reviews and merging</a></p></li>
<li><p><a class="reference internal" href="#flag-mechanism" id="id20">Flag mechanism</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#package-maintenance" id="id21">Package maintenance</a></p>
<ul>
<li><p><a class="reference internal" href="#classes-of-packages" id="id22">Classes of packages</a></p></li>
<li><p><a class="reference internal" href="#maintainers" id="id23">Maintainers</a></p></li>
<li><p><a class="reference internal" href="#bug-reporting" id="id24">Bug reporting</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#implementation-choices" id="id25">Implementation choices</a></p>
<ul>
<li><p><a class="reference internal" href="#implementation-requirements" id="id26">Implementation requirements</a></p></li>
<li><p><a class="reference internal" href="#git-hosting-solutions" id="id27">Git hosting solutions</a></p>
<ul>
<li><p><a class="reference internal" href="#gitolite-cgit-setup-used-by-gentoo" id="id28">gitolite + cgit setup used by Gentoo</a></p></li>
<li><p><a class="reference internal" href="#github-and-similar-saas-solutions" id="id29">GitHub (and similar SaaS solutions)</a></p></li>
<li><p><a class="reference internal" href="#gitlab-and-similar-platforms-infra-deployment" id="id30">GitLab and similar platforms (Infra deployment)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#custom-review-front-end-design" id="id31">Custom review front-end design</a></p>
<ul>
<li><p><a class="reference internal" href="#web-based-front-end" id="id32">Web-based front-end</a></p></li>
<li><p><a class="reference internal" href="#git-based-front-end" id="id33">Git-based front-end</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#questions-answers" id="id34">Questions &amp; answers</a></p>
<ul>
<li><p><a class="reference internal" href="#guru-vs-other-projects" id="id35">GURU vs other projects</a></p></li>
<li><p><a class="reference internal" href="#guru-for-users" id="id36">GURU for users</a></p></li>
<li><p><a class="reference internal" href="#the-acronym" id="id37">The acronym</a></p></li>
<li><p><a class="reference internal" href="#the-logo" id="id38">The logo</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#references" id="id39">References</a></p></li>
</ul>
</div>
<div class="section" id="preface">
<h1><a class="toc-backref" href="#id7">Preface</a></h1>
<p>Gentoo accepts user contributions via a number of venues.  Bugzilla,
the most traditional of them is suitable for helping developers fix
their packages but is strictly developer-oriented.  Proxy maintenance
is a great way to maintain packages by non-developers but requires
significant effort from both contributors and developers.  Third-party
repositories are cheap to create but not friendly to end users.</p>
<p>All this considered, there seems to be a gap between overlays and proxy
maintenance.  GURU aims to fill this gap, by combining relatively low
effort required to push with high visibility of well-known official
repository.  While using a rather different design, it is meant to be to
Gentoo what AUR is to Arch Linux.  <a class="footnote-reference brackets" href="#aur" id="id1">1</a></p>
<p>The project is somewhat similar to Sunrise, except that it eliminates
the reliance on developers to review commits.  Instead, it focuses
on Wiki-like community workflow where everybody can work together
to improve packages, and users gain reputation via doing good work.
Users who already gained reputation use it to review packages, merge
them for public consumption and at the same time raise reputation
of the users submitting them.  This creates self-sustainable community
where Gentoo developer intervention is rarely necessary.</p>
</div>
<div class="section" id="existing-and-historical-contribution-models">
<h1><a class="toc-backref" href="#id8">Existing and historical contribution models</a></h1>
<div class="section" id="bugzilla-and-e-mail-submissions">
<h2><a class="toc-backref" href="#id9">Bugzilla and e-mail submissions</a></h2>
<p>Over the history of Gentoo, I think Bugzilla can clearly be classified
as the primary venue of interaction between users and developers.  Be it
bug reports, enhancement suggestions or new package requests, all
of them allowed for the users to attach patches or new ebuilds.</p>
<p>The most important characteristic of this venue is that the result
of user's action entirely relied on an existing Gentoo developer taking
care of it.  The files attached by the users may help the developer but
the user can not directly cause anything to happen.  If user submits
a new package, he can't make it happen without finding an interested
developer.</p>
<p>Bugzilla is presented as a canonical example of this contribution model.
The same model is expressed e.g. by e-mail submissions, IRC pastes, etc.</p>
</div>
<div class="section" id="the-sunrise-project-historical">
<h2><a class="toc-backref" href="#id10">The Sunrise project (historical)</a></h2>
<p>The Sunrise project was a historical Gentoo project built around
user-maintained, developer-reviewed package repository.  At the time
when I joined Gentoo, it was the primary venue for users to work on new
packages and receive training necessary to become Gentoo developers.
After all, many new Gentoo developers at the time (myself included)
started with Sunrise.</p>
<p>The Sunrise model was based on a repository with two branches: a main
branch where all users worked and a reviewed branch that was meant for
public consumption.  All users were expected to request review on IRC
for their changes, and only commit once receiving an approval from
a Sunrise developer.  Furthermore, Sunrise developers periodically did
review late commits (again) and merge them to the reviewed branch.</p>
<p>Sunrise eventually become defunct due to loss of interest both
on developer and user side.  Eventually, it has been discontinued
in June 2016.  <a class="footnote-reference brackets" href="#sunrise" id="id2">2</a></p>
</div>
<div class="section" id="proxied-maintainers">
<h2><a class="toc-backref" href="#id11">Proxied maintainers</a></h2>
<p>The downfall of Sunrise was paralleled by rise of proxy-maintenance.
In this model, users are allowed to maintain packages straight
in the Gentoo repository, with one or more developers proxying
the commits for them.</p>
<p>While this concept has been (and still is) applied to individual
user-developer pairs, forming the Proxy Maintainers project was
a turning point for its growth.  This project focused on gathering
developers that were interested in serving users as proxies,
and eventually replaced the 1:1 model with M:N where a number of
developers freely proxy a number of users.  <a class="footnote-reference brackets" href="#proxy-maint" id="id3">3</a></p>
<p>The historical purpose of proxy-maint project was to find new
maintainers for abandoned packages in Gentoo.  Today (and especially
since GitHub was adopted) the majority of submissions involves new
packages.</p>
<p>The main advantage of proxy-maint is that it allows the users to take
responsibility and share their work to all Gentoo users through
the official repository.  However, applying those contributions requires
significant effort both from users and developers, and so far
the proxy-maint team is continuously overwhelmed and unable to process
contributions in satisfactory time.</p>
</div>
<div class="section" id="user-repositories-overlays">
<h2><a class="toc-backref" href="#id12">User repositories (overlays)</a></h2>
<p>Finally, another possibility for users to publish their work is to
create their own repositories, historically called ‘overlays’.  There
is a great multitude of kinds of repositories and their uses.  We have
personal, project and quasi-public overlays.  We have repositories
focused on a single package suite, software category, and holding all
different kinds of applications.  We have cross-repository dependencies,
we have overrides for Gentoo packages.  We have repositories of great
quality, and literal ‘dumps’ of random ebuilds.  Finally, we have
completely unpredictable mixes of all that.</p>
<p>The most important advantage of third party repositories is that they
are trivial to create and cheap to maintain.  You can practically commit
anything you like to your personal overlay, without having to pass any
review or convince any Gentoo developer to accept it.  With a little
more effort, you can get it published on the official list, and make
it possible for users to trivially start using it.</p>
<p>However, this implies all disadvantages of the generic case of this
model.  Users are subject to a great number of repositories of varying
quality and size.  If you need to find a particular package, you may be
required to choose from a number of overlays with no clear indication
which may serve your purpose better.  If you add a particular overlay,
you may discover it actually overrides other packages you did not want
replaced.  Finally, since there's no real supervision of what happens
in all those repositories, it is trivial to inject malware.</p>
</div>
<div class="section" id="project-repositories">
<h2><a class="toc-backref" href="#id13">Project repositories</a></h2>
<p>I believe it is worthwhile to isolate a special case of third-party
repositories — project overlays.  Besides aforementioned Sunrise
project, some examples of long-lived Gentoo project overlays are
the GNOME, KDE, Science or Java overlays.</p>
<p>Their distinguishing quality is that they are focused on a specific yet
broad topic and supervised by actual Gentoo developers.  However, they
frequently give commit access to various external contributors,
providing them with an opportunity to work with the project members (or
even become them — if you disregard the limitation of Gentoo Wiki
preventing non-developer project members).</p>
<p>Furthermore, those project overlays frequently serve as staging ground
for Gentoo repository ebuilds.  Therefore, the work of users eventually
makes it to the official repository.</p>
</div>
<div class="section" id="effort-reach-comparison">
<h2><a class="toc-backref" href="#id14">Effort-reach comparison</a></h2>
<div class="figure align-center">
<img alt="guru-a-new-model-of-contributing-to-gentoo/contrib-method-chart.svg" src="guru-a-new-model-of-contributing-to-gentoo/contrib-method-chart.svg" />
<p class="caption">Chart presenting effort-to-user-reach for different contribution
venues</p>
</div>
<p>The above chart attempts to describe where GURU fits graphically.
The vertical axis represents the <em>effort</em>, i.e. how much time and work
adding a package takes.  The horizontal axis represents <em>user reach</em>,
i.e. how many users will find the package added.</p>
<p>The middle line representing Bugzilla is taken as a reference point.
In case of Bugzilla, the actual reach depends on whether any developer
actually takes the patch/ebuild.</p>
<p>On one end of the graph, we have user repositories where
the effort is relatively low and user reach depends on the popularity
of particular repository.  On the other end, we have commits made
directly to the Gentoo repository which have the highest reach.</p>
<p>Proxy-maint is placed above Gentoo as reviewing and training
contributors requires more effort (and of more people) than committing
packages yourself.  Sunrise is nearby, with its high standards still
requiring significant effort and good popularity.</p>
<p>GURU aims to achieve similar level of popularity as Sunrise; however
with lower cumulative effort.  On one hand, some users will take
the extra effort to review packages.  On the other, it also provides for
one-time package submitters.</p>
</div>
</div>
<div class="section" id="the-proposed-guru-model">
<h1><a class="toc-backref" href="#id15">The proposed GURU model</a></h1>
<div class="section" id="repository-layout">
<h2><a class="toc-backref" href="#id16">Repository layout</a></h2>
<p>GURU uses a layout similar to the one historically used by the Sunrise
project.  There are two branches: the development branch maintained
directly by users, and the reviewed branch intended for public
consumption.</p>
<p>All GURU users obtain access to the development branch upon requesting
it.  Since this opens a possibility of seriously broken or even
malicious code being committed, this branch is only intended to be used
by GURU contributors, and only in the scope specific to their individual
development efforts (i.e. even they should not add it to
<span class="docutils literal">repos.conf</span>).</p>
<p>The reviewed branch is entirely maintained by scripts.  The commits
from development branch are merged into reviewed branch as soon as they
are reviewed, through automated scripts.</p>
</div>
<div class="section" id="user-access-and-workflow">
<h2><a class="toc-backref" href="#id17">User access and workflow</a></h2>
<div class="section" id="classes-of-users">
<h3><a class="toc-backref" href="#id18">Classes of users</a></h3>
<p>Initially, three user classes are defined:</p>
<ol class="arabic simple">
<li><p><em>Regular users</em> — all new users belong to this class.  Regular users
are permitted to commit to the development branch, and to flag
commits.  However, they can't review packages.</p></li>
<li><p><em>Trusted users</em> — regular users are promoted to trusted users once
they gain 10 reputation points.  Trusted users can additionally
review commits and therefore effect their merge to the reviewed
branch.</p></li>
<li><p><em>Developers</em> — existing Gentoo developers belong to this class.  They
are permitted to review commits and also to remove flags.</p></li>
</ol>
<p>Users gain 1 reputation point every time a batch of commits containing
their commit is merged.  In other words, a user becomes trusted after
reaching 10 accepted separate contributions.</p>
<p>This model aims to provide self-sustainable user community while
protecting the repository against using newly-created accounts to
perform malicious actions.  While new users could potentially commit
malicious code, it would have to normally pass review of multiple
already trusted individuals which is unlikely.  In order to be able to
review their own code, they would have to first put an effort into
gaining trusted user status.</p>
<p>Gentoo developers are given special status for two reasons: firstly,
to act as moderators who can react to acts of malice or vandalism;
and secondly, as initial group needed to bootstrap the trusted user
model.  Once initial developer reviews elect first trusted users, those
users can take most of the reviewing over and the repository becomes
self-sustainable.</p>
</div>
<div class="section" id="commit-reviews-and-merging">
<h3><a class="toc-backref" href="#id19">Commit reviews and merging</a></h3>
<p>The commit reviews are also based on scoring system.  Reviews are
normally performed on commit ranges, and each approval gives all commits
in the range specific score:</p>
<ul class="simple">
<li><p>1 point if the review is performed by a trusted user,</p></li>
<li><p>3 points if the review is performed by a developer.</p></li>
</ul>
<p>Once a commit reaches the score of 3 points, it can be merged to
the reviewed branch.  This implies that normally the reviewed branch
is merged either if a developer reviews commits, or 3 distinct trusted
users do.</p>
</div>
<div class="section" id="flag-mechanism">
<h3><a class="toc-backref" href="#id20">Flag mechanism</a></h3>
<p>The flag mechanism is added in order to provide stronger protection
against malicious or otherwise harmful actions.  Any user (including
untrusted users) can flag a commit as either <em>malicious</em>, <em>vandalising</em>
or <em>suspicious</em>.  The flagged commit is reported to the community
and blocks merging the changeset, even if it reached the necessary
score.</p>
<p>Once a flag is set, it can only be removed by a developer.  Once
the developer confirms that the danger is resolved, the flag is removed
and merging can proceed again.  The developer can also issue bans
and other measures against the individual responsible for the commit.</p>
</div>
</div>
<div class="section" id="package-maintenance">
<h2><a class="toc-backref" href="#id21">Package maintenance</a></h2>
<div class="section" id="classes-of-packages">
<h3><a class="toc-backref" href="#id22">Classes of packages</a></h3>
<p>The GURU repository is primarily meant for new packages, that is
packages that are not present in the Gentoo repository.  Additionally,
it is acceptable to provide new versions of packages that are
unmaintained.  It is <em>not</em> acceptable to override Gentoo packages;
if there is a very good reason to fork them, the fork should be named
accordingly and not interfere with the Gentoo original.</p>
<p>Accordingly, if a GURU package is adapted (or independently added)
into the Gentoo repository, it should be afterwards removed from GURU.
This removal can be done by anyone.</p>
</div>
<div class="section" id="maintainers">
<h3><a class="toc-backref" href="#id23">Maintainers</a></h3>
<p>GURU allows for both community-maintained and individual-maintained
packages.  However, it enforces no technical access restrictions nor
strong maintainer boundaries.  The former class of packages is
identified by lack of maintainer in <span class="docutils literal">metadata.xml</span> (or an explicit
comment stating that community contributions are welcome), the latter
by an explicitly listed maintainer.</p>
<p>The primary purpose of defined maintainers is to provide a contact point
for bugs reported against the package in question.  If other users wish
to contribute to the package, it is a good practice to contact
the listed maintainer first.  However, there is no punishment planned
for non-destructive cases of non-maintainer commits.</p>
</div>
<div class="section" id="bug-reporting">
<h3><a class="toc-backref" href="#id24">Bug reporting</a></h3>
<p>All bugs reported to GURU packages will be reported both to specific
package maintainers and a GURU mailing list including all users.  All
users are responsible for keeping GURU in good shape, and therefore all
users are asked to process bug reports.</p>
</div>
</div>
</div>
<div class="section" id="implementation-choices">
<h1><a class="toc-backref" href="#id25">Implementation choices</a></h1>
<div class="section" id="implementation-requirements">
<h2><a class="toc-backref" href="#id26">Implementation requirements</a></h2>
<p>The GURU project requires a git hosting and a review system.
The cumulative requirements for both are:</p>
<ul class="simple">
<li><p>user access control, with accounts being associated to commits,</p></li>
<li><p>git update hooks that can reject non-conformant commits,</p></li>
<li><p>per-branch access control,</p></li>
<li><p>possibility for minimal CI integration (i.e. commit status
information visibility),</p></li>
<li><p>ability to store per-user and per-commit reputation and flags,</p></li>
<li><p>ability to distinguish user types and their limitations in reviews
and flag control,</p></li>
<li><p>good diff view.</p></li>
</ul>
<p>Both elements can either be part of a single product, or be made of two
or more complementary pieces.  Notably, the review system will most
likely require some custom coding; though it would be desirable to reuse
as much of existing systems as possible.</p>
</div>
<div class="section" id="git-hosting-solutions">
<h2><a class="toc-backref" href="#id27">Git hosting solutions</a></h2>
<div class="section" id="gitolite-cgit-setup-used-by-gentoo">
<h3><a class="toc-backref" href="#id28">gitolite + cgit setup used by Gentoo</a></h3>
<p>Gitolite is a git hosting backend focused on SSH access, and featuring
configuration via git repository.  It is pretty powerful, allowing
for a lot of customization, including per-branch access control and any
set of git hooks.  The account creation is manual; however, it can
easily be semi-automated using scripts, so that should not cause
an issue as long as GURU continues to require manual account approval.
<a class="footnote-reference brackets" href="#gitolite" id="id4">4</a></p>
<p>cgit is a web frontend for git repositories.  Its most notable quality
is that it is written in C (based on hacking git sources) and this gives
it great performance compared to the alternatives.  However, it is
focused on read-only access to the repositories and does not supply
anything very useful for the project.  <a class="footnote-reference brackets" href="#cgit" id="id5">5</a></p>
<p>An important advantage of the two is that Gentoo Infrastructure has them
deployed.  Therefore, taking advantage of them might both reduce
the amount of extra work necessary and avoid the discontent proprietary
alternatives would cause.  However, there are many areas (reviews, CI
integration) that would need to be implemented separately.</p>
</div>
<div class="section" id="github-and-similar-saas-solutions">
<h3><a class="toc-backref" href="#id29">GitHub (and similar SaaS solutions)</a></h3>
<p>GitHub is presented here as an example of a SaaS solution.  There are
multiple alternatives, more or less with the same functionality,
therefore I do not find it necessary to consider them separately.</p>
<p>GitHub is probably the biggest proprietary hosting site for git
repositories.  It provides free hosting for public repositories,
along with a number of useful features.  I am going to consider them
in context of possible GURU implementation.  <a class="footnote-reference brackets" href="#github" id="id6">6</a></p>
<p>GitHub makes it trivial to add new users to repositories.  Notably, it
removes the necessity of manually maintaining SSH keys, and given its
popularity it enables a number of users to contribute without having
to create a separate account.</p>
<p>It provides for good integration with external applications, including
some free SaaS CI providers and possible external software written
to provide status checks, reviews, etc.  Besides providing API access
to the repository and its GitHub-specific features, it also provides SSO
that could avoid maintaining two account systems.</p>
<p>On the negative side, its flexibility is limited.  It does not provide
for third-party update hooks.  While branch restrictions could be used
to implement a subset of GURU review goals (a protected branch where
people could only merge commits via creating a pull request and having
it reviewed by N other users), they are not powerful enough to implement
the full goal set.</p>
<p>Finally, since the service is proprietary some users are vehemently
opposed to using it.  This problem could possibly be lessened by using
open source SaaS such as GitLab but not eliminated entirely.</p>
</div>
<div class="section" id="gitlab-and-similar-platforms-infra-deployment">
<h3><a class="toc-backref" href="#id30">GitLab and similar platforms (Infra deployment)</a></h3>
<p>TODO</p>
</div>
</div>
<div class="section" id="custom-review-front-end-design">
<h2><a class="toc-backref" href="#id31">Custom review front-end design</a></h2>
<div class="section" id="web-based-front-end">
<h3><a class="toc-backref" href="#id32">Web-based front-end</a></h3>
<p>Common project design practices suggest that the review front-end should
be built as web application.  Such an application would have to provide
a user-friendly review UI with clean diff view, easy access to common
review actions and clean indication of commit states.  Such a task is
entirely doable.</p>
<p>However, web UI poses a specific problem: since SSH (as used to
authenticate committers) is not really suitable for regular HTTPS
authentication, it requires a duplicate account system with a different
authentication mechanism.  This is technically doable, especially that
all the common frameworks provide such a system.  However, it increases
account maintenance overhead.</p>
</div>
<div class="section" id="git-based-front-end">
<h3><a class="toc-backref" href="#id33">Git-based front-end</a></h3>
<p>One particularly interesting alternative is to use git as database
directly, rather than requiring a separate web front-end.  In this
model, the reviewing is done via a dedicated CLI or GUI application
that afterwards stores results as specific git objects.  The action
is committed via pushing the objects to server.</p>
<p>Most notably, this removes the necessity for a separate authentication
mechanism.  Since all actions are pushed via git, the existing git
authentication framework will suffice.  However, at the same time it
becomes necessary for the server-side hooks to be able to verify
the incoming requests and reject those which exceed user's permissions.</p>
<p>Furthermore, unless we can use additional server-side data storage,
it becomes necessary for the hook to repeatedly reevaluate user
and commit status in order to devise appropriate actions.  For example,
when users submit a commit range review, the system would need to first
reevaluate user's reputation, verify whether he is allowed to submit
the review, apply appropriate commit reputation updates and finally
reevaluate the resulting reputation of individual commits and possibly
merge them to the reviewed branch.</p>
</div>
</div>
</div>
<div class="section" id="questions-answers">
<h1><a class="toc-backref" href="#id34">Questions &amp; answers</a></h1>
<div class="section" id="guru-vs-other-projects">
<h2><a class="toc-backref" href="#id35">GURU vs other projects</a></h2>
<dl class="simple">
<dt>Will GURU replace proxy-maint (/ some other project)?</dt>
<dd><p>No, GURU is meant to be an entirely new project, aiming to fill
in a specific gap.  While it is possible that some users will resign
from contributing via proxy-maint in favor of GURU, it should be noted
that unlike proxy-maint, it does not provide a way to get your
packages to the Gentoo repository.</p>
</dd>
<dt>How is GURU different from Sunrise?</dt>
<dd><p>There are indeed many similarities between GURU and Sunrise.  However,
the main difference is that Sunrise explicitly relied on developers
reviewing all the commits, while GURU aims to build a self-sustainable
reviewer base within the user community.</p>
</dd>
<dt>Why not revive Sunrise instead?</dt>
<dd><p>I believe that Sunrise died mostly because of lack of interest.  While
bringing it up again might get it running for some time, there is
no reason to believe that it would meet the same end soon enough.
Therefore, I think it is better to try something else.</p>
</dd>
</dl>
</div>
<div class="section" id="guru-for-users">
<h2><a class="toc-backref" href="#id36">GURU for users</a></h2>
<dl>
<dt>Will GURU repository by enabled by default?</dt>
<dd><p>There are no such plans at the moment, and I honestly doubt it will
happen in the future, at least with the currently planned contribution
model.  Most notably, GURU is not meant to force the high standards
that are (at least theoretically) required for the Gentoo repository.</p>
</dd>
<dt>How is GURU protected against malicious users?</dt>
<dd><p>The primary protection is the review model.  If a malicious user
obtains access to the repository (which is entirely possible given
no specific verification of new users), existing users should be able
to notice his actions and reject them at review level.</p>
<p>For a malicious agent to be able to push changes to the reviewed
repository itself, it would technically need to create three users
first, and obtain trusted user status for each of them.  While this is
not impossible, it is considered costly enough to limit the attack
scope.  Of course, once the resulting attack is noticed, the accounts
will be blocked and the attacker would have to start over.</p>
<p>A malicious user causing mayhem in the development repository is
a more likely threat.  However, this will not reach end users,
so the end value of such an attack would be rather low (i.e. it would
be vandalism).  Furthermore, all the accounts will be confirmed
manually, technically restricting the ability of quickly creating
multiple accounts.</p>
</dd>
</dl>
</div>
<div class="section" id="the-acronym">
<h2><a class="toc-backref" href="#id37">The acronym</a></h2>
<dl class="simple">
<dt>What does GURU stand for?</dt>
<dd><p>It's a secret known only to the most trusted GURU users.  However,
the expansion most likely includes the words ‘Gentoo’, ‘User’
and ‘Repository’.  Not necessarily in this order.</p>
</dd>
<dt>…but what about the second ‘U’?</dt>
<dd><p>Yeah, the little bugger likes to make trouble.  However, it wouldn't
be half as cool without it — imagine GUR, or maybe GRU (but then we
would risk being despicable).  Choose some U-word yourself.
Suggestions include ‘Unique’, ‘Ubiqi… Ubiquitous!’, ‘Umbrella’,
‘Ubuntu’… oh, wait.</p>
</dd>
<dt>Is GURU a recursive acronym?</dt>
<dd><p>Sure, why not.  ‘GURU Ur Repository, Umph!’</p>
</dd>
<dt>Why is there a whole section dedicated to the acronym?</dt>
<dd><p>Because it is the single most important quality of the project!
Do you think anyone would have really look at it if it was named
‘random new user-contributed repository without a cool acronym’?
Do you think I would be motivated to actually design this and deal
with all the criticism if I haven't thought of that acronym
in the first place and didn't want it to go to waste?  I don't think
so.</p>
</dd>
</dl>
</div>
<div class="section" id="the-logo">
<h2><a class="toc-backref" href="#id38">The logo</a></h2>
<dl class="simple">
<dt>What's with the 9… I mean, G?</dt>
<dd><p>It was supposed to resemble the Gentoo ‘g’.  Except after four
strikes, it looked kinda non-g, so I've added the fifth strike.  Then,
a few minutes later I've realized that it's flipped horizontally.
However, since it was a few minutes after its inception, it became
classic already and I didn't change it.  After all, isn't the Gentoo
‘g’ flipped actually?</p>
</dd>
<dt>What's with the V?</dt>
<dd><p>Look at some random ancient Latin writings, and you're going to notice
‘U’ being written as ‘V’.  The logo follows that tradition.
For no reason whatsoever.</p>
</dd>
<dt>Is there anything special about the R?</dt>
<dd><p>Nope, sorry.  Incidentally it looks like R, behaves like R and nobody
so far has had any reason to think otherwise.  If anything changes,
I'll let you know.</p>
</dd>
<dt>What are those squares in the background?</dt>
<dd><p>That's Braille alphabet, obviously.  I do care about accessibility,
and since the cost of adding Braille name was practically
non-existent, why not?</p>
</dd>
<dt>What are those dots and dashes below?</dt>
<dd><p>Morse code, obviously.  Probably doesn't have any value.</p>
</dd>
<dt>What's with the cow?</dt>
<dd><p>What cow?</p>
</dd>
<dt>The cow on the logo.  The one below the GURU.</dt>
<dd><p>Someone asked for it, so I've added it.</p>
</dd>
<dt>…but who's that cow?  Is that supposed to be Larry?</dt>
<dd><p>That's Леони́д, Larry's gender-neutral sibling who's been kidnapped
by mad СССР scientists.  Don't ask him about the spots.</p>
</dd>
<dt>Are you serious?</dt>
<dd><p>Nope.</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="references">
<h1><a class="toc-backref" href="#id39">References</a></h1>
<dl class="footnote brackets">
<dt class="label" id="aur"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Arch User Repository - ArchWiki
(<a class="reference external" href="https://wiki.archlinux.org/index.php/Arch_User_Repository">https://wiki.archlinux.org/index.php/Arch_User_Repository</a>)</p>
</dd>
<dt class="label" id="sunrise"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>Sunrise - Gentoo Wiki
(<a class="reference external" href="https://wiki.gentoo.org/wiki/Sunrise">https://wiki.gentoo.org/wiki/Sunrise</a>)</p>
</dd>
<dt class="label" id="proxy-maint"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>Project:Proxy Maintainers - Gentoo Wiki
(https://wiki.gentoo.org/wiki/Project:Proxy_Maintainers)</p>
</dd>
<dt class="label" id="gitolite"><span class="brackets"><a class="fn-backref" href="#id4">4</a></span></dt>
<dd><p>Gitolite
(<a class="reference external" href="http://gitolite.com/gitolite/">http://gitolite.com/gitolite/</a>)</p>
</dd>
<dt class="label" id="cgit"><span class="brackets"><a class="fn-backref" href="#id5">5</a></span></dt>
<dd><p>cgit - A hyperfast web frontend for git repositories written
in C
(<a class="reference external" href="https://git.zx2c4.com/cgit/">https://git.zx2c4.com/cgit/</a>)</p>
</dd>
<dt class="label" id="github"><span class="brackets"><a class="fn-backref" href="#id6">6</a></span></dt>
<dd><p>GitHub
(<a class="reference external" href="https://github.com">https://github.com</a>)</p>
</dd>
</dl>
</div>
</div>
</body>
</html>
