<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<title>Portability of tar features</title>
<meta name="author" content="Michał Górny" />
<meta name="dcterms.date" content="2018-11-25" />
<meta name="dcterms.rights" content="https://creativecommons.org/licenses/by/3.0/" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/"/>
<style type="text/css">

/* Minimal style sheet for the HTML output of Docutils.                    */
/*                                                                         */
/* :Author: Günter Milde, based on html4css1.css by David Goodger          */
/* :Id: $Id: minimal.css 8642 2021-03-26 13:51:14Z milde $               */
/* :Copyright: © 2015 Günter Milde.                                        */
/* :License: Released under the terms of the `2-Clause BSD license`_,      */
/*    in short:                                                            */
/*                                                                         */
/*    Copying and distribution of this file, with or without modification, */
/*    are permitted in any medium without royalty provided the copyright   */
/*    notice and this notice are preserved.                                */
/*                                                                         */
/*    This file is offered as-is, without any warranty.                    */
/*                                                                         */
/* .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause     */

/* This CSS2.1_ stylesheet defines rules for Docutils elements without    */
/* HTML equivalent. It is required to make the document semantic visible. */
/*                                                                        */
/* .. _CSS2.1: http://www.w3.org/TR/CSS2                                  */
/* .. _validates: http://jigsaw.w3.org/css-validator/validator$link       */

/* titles */
p.topic-title,
p.admonition-title,
p.system-message-title {
  font-weight: bold;
}
p.sidebar-title,
p.rubric {
  font-weight: bold;
  font-size: larger;
}
p.rubric {
  color: maroon;
}
p.subtitle,
p.section-subtitle,
p.sidebar-subtitle {
  font-weight: bold;
  margin-top: -0.5em;
}
h1 + p.subtitle {
  font-size: 1.6em;
}
h2 + p.section-subtitle, a.toc-backref {
  color: black;
  text-decoration: none;
}

/* Warnings, Errors */
.system-messages h2,
.system-message-title,
span.problematic {
  color: red;
}

/* Inline Literals */
.docutils.literal {
  font-family: monospace;
  white-space: pre-wrap;
}
/* do not wrap at hyphens and similar: */
.literal > span.pre { white-space: nowrap; }

/* Lists */

/* compact and simple lists: no margin between items */
.simple  li, .simple  ul, .simple  ol,
.compact li, .compact ul, .compact ol,
.simple  > li p, dl.simple  > dd,
.compact > li p, dl.compact > dd {
  margin-top: 0;
  margin-bottom: 0;
}
/* Nested Paragraphs */
p:first-child { margin-top: 0; }
p:last-child { margin-bottom: 0; }
td > p, th > p { margin-bottom: 0; }

/* Table of Contents */
.topic.contents { margin: 0.5em 0; }
.topic.contents ul.auto-toc {
  list-style-type: none;
  padding-left: 1.5em;
}

/* Enumerated Lists */
ol.arabic     { list-style: decimal }
ol.loweralpha { list-style: lower-alpha }
ol.upperalpha { list-style: upper-alpha }
ol.lowerroman { list-style: lower-roman }
ol.upperroman { list-style: upper-roman }

/* Definition Lists and Derivatives */
dt .classifier { font-style: italic }
dt .classifier:before {
  font-style: normal;
  margin: 0.5em;
  content: ":";
}
/* Field Lists and similar */
/* bold field name, content starts on the same line */
dl.field-list > dt,
dl.option-list > dt,
dl.docinfo > dt,
dl.footnote > dt,
dl.citation > dt {
  font-weight: bold;
  clear: left;
  float: left;
  margin: 0;
  padding: 0;
  padding-right: 0.5em;
}
/* Offset for field content (corresponds to the --field-name-limit option) */
dl.field-list > dd,
dl.option-list > dd,
dl.docinfo > dd {
  margin-left:  9em; /* ca. 14 chars in the test examples, fit all Docinfo fields */
}
/* start field-body on a new line after long field names */
dl.field-list > dd > *:first-child,
dl.option-list > dd > *:first-child
{
  display: inline-block;
  width: 100%;
  margin: 0;
}
/* field names followed by a colon */
dl.field-list > dt:after,
dl.docinfo > dt:after {
  content: ":";
}

/* Bibliographic Fields (docinfo) */
dl.docinfo pre.address {
  font: inherit;
  margin: 0.5em 0;
}
dl.docinfo > dd.authors > p { margin: 0; }

/* Option Lists */
dl.option-list > dt { font-weight: normal; }
span.option { white-space: nowrap; }

/* Footnotes and Citations  */
dl.footnote.superscript > dd { margin-left: 1em; }
dl.footnote.brackets > dd { margin-left: 2em; }
dl.footnote > dt { font-weight: normal; }
a.footnote-reference.brackets:before,
dt.label > span.brackets:before { content: "["; }
a.footnote-reference.brackets:after,
dt.label > span.brackets:after { content: "]"; }
a.footnote-reference.superscript,
dl.footnote.superscript > dt.label {
  vertical-align: super;
  font-size: small;
}
dt.label > span.fn-backref {
  margin-left: 0.2em;
  font-weight: normal;
}
dt.label > span.fn-backref > a { font-style: italic; }

/* Alignment */
.align-left   {
  text-align: left;
  margin-right: auto;
}
.align-center {
  clear: both;
  text-align: center;
  margin-left: auto;
  margin-right: auto;
}
.align-right  {
  text-align: right;
  margin-left: auto;
}
.align-top    { vertical-align: top; }
.align-middle { vertical-align: middle; }
.align-bottom { vertical-align: bottom; }

/* reset inner alignment in figures and tables */
figure.align-left, figure.align-right,
table.align-left, table.align-center, table.align-right {
  text-align: inherit;
}

/* Text Blocks */
blockquote,
div.topic,
aside.topic {
  margin: 1em 2em;
}
.sidebar,
.admonition,
.system-message {
  border: thin solid;
  margin: 1em 2em;
  padding: 0.5em 1em;
}
.sidebar {
  width: 30%;
  max-width: 26em;
  float: right;
  clear: right;
}
div.line-block { display: block; }
div.line-block div.line-block, pre { margin-left: 2em; }

/* Code line numbers: dropped when copying text from the page */
pre.code .ln { display: none; }
pre.code code:before {
  content: attr(data-lineno); /* …, none) fallback not supported by any browser */
  color: gray;
}

/* Tables */
table {
  border-collapse: collapse;
}
td, th {
  border: thin solid silver;
  padding: 0 1ex;
}
.borderless td, .borderless th {
  border: 0;
  padding: 0;
  padding-right: 0.5em /* separate table cells */
}

table > caption {
  text-align: left;
  margin-top: 0.2em;
  margin-bottom: 0.2em;
}
table.captionbelow {
  caption-side: bottom;
}

/* Document Header and Footer */
header { border-bottom: 1px solid black; }
footer { border-top: 1px solid black; }

/* Images are block-level by default in Docutils */
/* New HTML5 block elements: set display for older browsers */
img, header, section, footer, aside, nav, main, article, figure, video {
  display: block;
}
/* inline images */
p img, p video, figure img, figure video {
  display: inline;
}

</style>
<style type="text/css">

/* CSS31_ style sheet for the output of Docutils HTML writers.             */
/* Rules for easy reading and pre-defined style variants.                  */
/*                                                                         */
/* :Author: Günter Milde, based on html4css1.css by David Goodger          */
/* :Id: $Id: plain.css 8636 2021-03-19 00:23:33Z milde $                                                               */
/* :Copyright: © 2015 Günter Milde.                                        */
/* :License: Released under the terms of the `2-Clause BSD license`_,      */
/*    in short:                                                            */
/*                                                                         */
/*    Copying and distribution of this file, with or without modification, */
/*    are permitted in any medium without royalty provided the copyright   */
/*    notice and this notice are preserved.                                */
/*                                                                         */
/*    This file is offered as-is, without any warranty.                    */
/*                                                                         */
/* .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause     */
/* .. _CSS3: http://www.w3.org/TR/CSS3                                     */


/* Document Structure */
/* ****************** */

/* "page layout" */
body {
  margin: 0;
  background-color: #dbdbdb;
}
main, footer, header {
  line-height:1.3;
  /* avoid long lines --> better reading */
  /* optimum is 45…75 characters/line <http://webtypography.net/2.1.2> */
  /* OTOH: lines should not be too short because of missing hyphenation, */
  max-width: 50rem;
  padding: 1px 2%; /* 1px on top avoids grey bar above title (mozilla) */
  margin: auto;
}
main {
  counter-reset: table figure;
  background-color: white;
}
footer, header {
  font-size: smaller;
  padding: 0.5em 2%;
  border: none;
}

/* Transitions */
hr.docutils {
  width: 80%;
  margin-top: 1em;
  margin-bottom: 1em;
  clear: both;
}

/* Paragraphs */

/* vertical space (parskip) */
p, ol, ul, dl, li, dd,
div.line-block,
div.topic,
table {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}
p:first-child { margin-top: 0; }
/* (:last-child is new in CSS 3) */
p:last-child  { margin-bottom: 0; }

h1, h2, h3, h4, h5, h6,
dl > dd {
  margin-bottom: 0.5em;
}

/* Lists */
/* ===== */

/* Separate list entries in compound lists */
dl > dd, ol > li,

/* Definition Lists */
/* Indent lists nested in definition lists */
/* (:only-child is new in CSS 3)           */
dd > ul:only-child, dd > ol:only-child { padding-left: 1em; }

/* Description Lists */
/* styled like in most dictionaries, encyclopedias etc. */
dl.description > dt {
  font-weight: bold;
  clear: left;
  float: left;
  margin: 0;
  padding: 0;
  padding-right: 0.5em;
}

/* Field Lists */

/* example for custom field-name width */
dl.field-list.narrow > dd {
  margin-left: 5em;
}
/* run-in: start field-body on same line after long field names */
dl.field-list.run-in > dd p {
  display: block;
}

/* Bibliographic Fields */

/* generally, bibliographic fields use special definition list dl.docinfo */
/* but dedication and abstract are placed into "topic" divs */
div.abstract p.topic-title {
  text-align: center;
}
div.dedication {
  margin: 2em 5em;
  text-align: center;
  font-style: italic;
}
div.dedication p.topic-title {
  font-style: normal;
}

/* Text Blocks */
/* =========== */

/* Literal Blocks */
pre.literal-block, pre.doctest-block,
pre.math, pre.code {
  font-family: monospace;
}

/* Block Quotes */
blockquote > table,
div.topic > table {
  margin-top: 0;
  margin-bottom: 0;
}
blockquote p.attribution,
div.topic p.attribution {
  text-align: right;
  margin-left: 20%;
}

/* Tables */
/* ====== */

/* th { vertical-align: bottom; } */

table tr { text-align: left; }

/* "booktabs" style (no vertical lines) */
table.booktabs {
  border: 0;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.booktabs * {
  border: 0;
}
table.booktabs th {
  border-bottom: thin solid;
}

/* numbered tables (counter defined in div.document) */
table.numbered > caption:before {
  counter-increment: table;
  content: "Table " counter(table) ": ";
  font-weight: bold;
}

/* Explicit Markup Blocks */
/* ====================== */

/* Footnotes and Citations */
/* ----------------------- */

/* line on the left */
dl.footnote {
  padding-left: 1ex;
  border-left: solid;
  border-left-width: thin;
}

/* Directives */
/* ---------- */

/* Body Elements */
/* ~~~~~~~~~~~~~ */

/* Images and Figures */

/* let content flow to the side of aligned images and figures */
figure.align-left,
img.align-left,
video.align-left,
object.align-left {
  clear: left;
  float: left;
  margin-right: 1em;
}
figure.align-right,
img.align-right,
video.align-right,
object.align-right {
  clear: right;
  float: right;
  margin-left: 1em;
}
/* Stop floating sidebars, images and figures */
h1, h2, h3, h4, footer, header { clear: both; }

/* Numbered figures */
figure.numbered > figcaption > p:before {
  counter-increment: figure;
  content: "Figure " counter(figure) ": ";
  font-weight: bold;
}

/* Admonitions and System Messages */
.caution p.admonition-title,
.attention p.admonition-title,
.danger p.admonition-title,
.error p.admonition-title,
.warning p.admonition-title,
div.error {
  color: red;
}

/* Sidebar */
/* Move right. In a layout with fixed margins, */
/* it can be moved into the margin.            */
aside.sidebar {
  width: 30%;
  max-width: 26em;
  margin-left: 1em;
  margin-right: -2%;
  background-color: #ffffee;
}

/* Code */
pre.code { padding: 0.7ex }
pre.code, code { background-color: #eeeeee }
/* basic highlighting: for a complete scheme, see */
/* http://docutils.sourceforge.net/sandbox/stylesheets/ */
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

/* Math */
/* styled separately (see math.css for math-output=HTML) */

/* Epigraph           */
/* Highlights         */
/* Pull-Quote         */
/* Compound Paragraph */
/* Container          */

/* Inline Markup */
/* ============= */

/* Inline Literals                                          */
/* possible values: normal, nowrap, pre, pre-wrap, pre-line */
/*   span.docutils.literal { white-space: pre-wrap; }       */

/* Hyperlink References */
a { text-decoration: none; }

/* External Targets       */
/*   span.target.external */
/* Internal Targets       */
/*   span.target.internal */
/* Footnote References    */
/*   a.footnote-reference */
/* Citation References    */
/*   a.citation-reference */

</style>
</head>
<body class="with-toc">
<main id="portability-of-tar-features">
<h1 class="title">Portability of tar features</h1>
<dl class="docinfo simple">
<dt class="author">Author</dt>
<dd class="author"><p>Michał Górny</p></dd>
<dt class="date">Date</dt>
<dd class="date">2018-11-25</dd>
<dt class="version">Version</dt>
<dd class="version">1.1</dd>
<dt class="copyright">Copyright</dt>
<dd class="copyright"><a class="reference external" href="https://creativecommons.org/licenses/by/3.0/">https://creativecommons.org/licenses/by/3.0/</a></dd>
</dl>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#preface" id="id12">Preface</a></p></li>
<li><p><a class="reference internal" href="#implementations-tested" id="id13">Implementations tested</a></p></li>
<li><p><a class="reference internal" href="#test-inputs" id="id14">Test inputs</a></p></li>
<li><p><a class="reference internal" href="#common-tar-formats" id="id15">Common tar formats</a></p></li>
<li><p><a class="reference internal" href="#portability-test-results" id="id16">Portability test results</a></p>
<ul>
<li><p><a class="reference internal" href="#tar-format-acceptance" id="id17">Tar format acceptance</a></p></li>
<li><p><a class="reference internal" href="#long-pathnames" id="id18">Long pathnames</a></p></li>
<li><p><a class="reference internal" href="#large-file-sizes" id="id19">Large file sizes</a></p></li>
<li><p><a class="reference internal" href="#user-and-group-information" id="id20">User and group information</a></p></li>
<li><p><a class="reference internal" href="#timestamps" id="id21">Timestamps</a></p></li>
<li><p><a class="reference internal" href="#extended-file-metadata" id="id22">Extended file metadata</a></p>
<ul>
<li><p><a class="reference internal" href="#acls" id="id23">ACLs</a></p></li>
<li><p><a class="reference internal" href="#file-flags" id="id24">File flags</a></p></li>
<li><p><a class="reference internal" href="#generic-extended-attributes" id="id25">Generic extended attributes</a></p></li>
<li><p><a class="reference internal" href="#attribute-support-test" id="id26">Attribute support test</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#sparse-files" id="id27">Sparse files</a></p></li>
<li><p><a class="reference internal" href="#volume-label" id="id28">Volume label</a></p></li>
<li><p><a class="reference internal" href="#multi-volume-archives" id="id29">Multi-volume archives</a></p></li>
<li><p><a class="reference internal" href="#feature-matrix" id="id30">Feature matrix</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#summary" id="id31">Summary</a></p></li>
<li><p><a class="reference internal" href="#references" id="id32">References</a></p></li>
</ul>
</div>
<section id="preface">
<h2><a class="toc-backref" href="#id12">Preface</a></h2>
<p>The tar format is one of the oldest archive formats in use.  It comes
as no surprise that it is ugly — built as layers of hacks on the older
format versions to overcome their limitations.  However, given
the POSIX standarization in late 80s and the popularity of GNU tar, you
would expect the interoperability problems to be mostly resolved
nowadays.</p>
<p>This article is directly inspired by my proof-of-concept work on new
binary package format for Gentoo.  My original proposal used volume
label to provide user- and file(1)-friendly way of distinguish our
binary packages.  While it is a GNU tar extension, it falls within POSIX
ustar implementation-defined file format and you would expect that
non-compliant implementations would extract it as regular files.  What I
did not anticipate is that some implementation reject the whole archive
instead.</p>
<p>This naturally raised more questions on how portable various tar formats
actually are.  To verify that, I have decided to analyze the standards
for possible incompatibility dangers and build a suite of test inputs
that could be used to check how various implementations cope with that.
This article describes those points and provides test results
for a number of implementations.</p>
<p>Please note that this article is focused merely on read-wise format
compatibility.  In other words, it establishes how tar files should
be written in order to achieve best probability that it will be read
correctly afterwards.  It does not investigate what formats the listed
tools can write and whether they can correctly create archives using
specific features.</p>
</section>
<section id="implementations-tested">
<h2><a class="toc-backref" href="#id13">Implementations tested</a></h2>
<p>For the purpose of the experiment, the following implementations were
tested:</p>
<ul class="simple">
<li><p><strong>GNU tar</strong> 1.30  <a class="footnote-reference brackets" href="#gnutar" id="id1">1</a></p></li>
<li><p><strong>libarchive</strong> 3.3.3  <a class="footnote-reference brackets" href="#libarchive" id="id2">2</a></p></li>
<li><p><strong>star</strong> 1.5.3 (Schily)  <a class="footnote-reference brackets" href="#star" id="id3">3</a></p></li>
<li><p><strong>NetBSD pax</strong> from NetBSD 8.0 CVS, fetched 2018-11-22 (with local
modifications to build on Linux)  <a class="footnote-reference brackets" href="#netbsd-pax" id="id4">4</a></p></li>
<li><p><strong>busybox</strong> tar 1.30.0  <a class="footnote-reference brackets" href="#busybox" id="id5">5</a></p></li>
<li><p><strong>Python</strong> tarfile module as provided by Python 3.7.0
<a class="footnote-reference brackets" href="#python-tarfile" id="id6">6</a></p></li>
<li><p><strong>p7zip</strong> 16.02  <a class="footnote-reference brackets" href="#p7zip" id="id7">7</a></p></li>
<li><p><strong>7-Zip</strong> 18.05 (using wine)  <a class="footnote-reference brackets" href="#zip" id="id8">8</a></p></li>
<li><p><strong>WinRAR</strong> 5.61 (proprietary, using wine)  <a class="footnote-reference brackets" href="#winrar" id="id9">9</a></p></li>
</ul>
</section>
<section id="test-inputs">
<h2><a class="toc-backref" href="#id14">Test inputs</a></h2>
<p>All the test inputs are uploaded to tar-test-inputs repository
<a class="footnote-reference brackets" href="#tar-test-inputs" id="id10">10</a>.  They are mostly tarballs produced by either GNU
tar or libarchive bsdtar, with a few manually hacked to achieve desired
results.</p>
<p>The large file test tarballs are double-compressed using gzip.
The inner compression is <span class="docutils literal">gzip <span class="pre">-1</span></span>, used to reduce the file sizes
from 8 GiB to 36 MiB while maintaining reasonable performance (warning!
it's a zipbomb!).  The outer compression is <span class="docutils literal">gzip <span class="pre">-9</span></span>, used to reduce
the file size further for the git checkout.</p>
</section>
<section id="common-tar-formats">
<h2><a class="toc-backref" href="#id15">Common tar formats</a></h2>
<p>A good reference on different tar formats is the <span class="docutils literal">tar(5)</span> manpage
from libarchive <a class="footnote-reference brackets" href="#tar-5" id="id11">11</a>.  Of particular interest are four standards
supported by GNU tar:</p>
<ul class="simple">
<li><p>Old <strong>v7</strong> tar format (<span class="docutils literal"><span class="pre">--format=v7</span></span>),</p></li>
<li><p>POSIX 1003.1-1988 (<strong>ustar</strong>) format (<span class="docutils literal"><span class="pre">--format=ustar</span></span>),</p></li>
<li><p>POSIX 1003.1-2001 (<strong>pax</strong>) format (<span class="docutils literal"><span class="pre">--format=pax</span></span>),</p></li>
<li><p><strong>GNU tar</strong> 1.13.x format (<span class="docutils literal"><span class="pre">--format=gnu</span></span>).</p></li>
</ul>
<p>Additionally, whenever applicable the two additional formats supported
by star were tested:</p>
<ul class="simple">
<li><p><strong>star</strong> format (the old variant),</p></li>
<li><p><strong>sun</strong> tar format.</p></li>
</ul>
<p>The old v7 tar format is the format used by the tar command supplied
with Unix v7, and apparently a common base for the remaining formats.
Its defining features are lack of magic bytes and severe limitations
(only regular files, hardlinks and symlinks; pathname up to 99 octets;
file size up to 8 GiB; user and group stored numerically).</p>
<p>The ustar format extends the v7 format by adding more header fields
into unused padding space.  It provides magic bytes along with version
field, user and group names up to 31 octets, support for more file types
and extension of pathname length with 154-octet prefix.  Some
of the implementations used draft version of ustar format that used
a different magic bytes and version.</p>
<p>The pax format extends the ustar format by allowing arbitrary attributes
to be stored as special archive members before the actual file entry.
This provides for unlimited length pathnames, file sizes; unlimited
precision timestamps, etc.  The defining feature of pax format is that
it allows for extensions, assuming that incompatible implementations
may write the extended attributes as regular files for user inspection.</p>
<p>The GNU tar format is derived from the v7 format separately from POSIX
formats.  It uses the same magic and version as the pre-POSIX ustar
format, and is partially compatible with it.  However, whereas ustar
provides for extending pathname length, GNU tar includes fields for
additional timestamps and some other metadata.  It also uses a few
additional member types to provide long pathnames and support for
multi-volume archives.</p>
<p>The star format is the format historically used by star implementation,
derived from v7 tar incompatibly with both ustar or GNU tar.  This
format does not carry ustar magic; incompatible implementations normally
recognize it as v7 tar then.  This format was later superseded by ustar-
compatible xstar and xustar formats.</p>
<p>The sun tar format is the format historically used by tar on SunOS.
It seems roughly equivalent to pax, except that uppercase <span class="docutils literal">X</span> file
flag is used in place of lowercase <span class="docutils literal">x</span>, and that additional member
type is provided for ACLs.</p>
</section>
<section id="portability-test-results">
<h2><a class="toc-backref" href="#id16">Portability test results</a></h2>
<section id="tar-format-acceptance">
<h3><a class="toc-backref" href="#id17">Tar format acceptance</a></h3>
<p>The goal of the first test is to verify whether the tar implementations
accept a trivial archive of given type.  The archive contains a single
regular file and does not use any extensions other than additional
timestamps that are stored by default.</p>
<p>For the purpose of the experiment, the following tar files were used:</p>
<ul class="simple">
<li><p><strong>v7</strong> format archive (with no magic),</p></li>
<li><p>POSIX <strong>ustar</strong> archive,</p></li>
<li><p><strong>pre</strong>-POSIX <strong>ustar</strong> archive (with old magic and version values),</p></li>
<li><p><strong>pax</strong> archive (with extended metadata),</p></li>
<li><p><strong>GNU</strong> tar archive,</p></li>
<li><p><strong>GNU</strong> tar <strong>-G</strong> archive (where the <span class="docutils literal"><span class="pre">-G</span></span> option causes additional
timestamps to be written),</p></li>
<li><p><strong>star</strong> format archive (the old format, not compatible with ustar),</p></li>
<li><p><strong>sun</strong> tar format archive (with extended metadata, alike pax).</p></li>
</ul>
<p>It should be noted that the pre-POSIX ustar format and GNU tar format
use the same values of magic bytes and version; however, they differ
in the use of some header fields.  Apparently, modern versions of GNU
tar default not to use atime/ctime fields which could be confused
with ustar's path prefix field.  An additional archive with those
fields explicitly forced was included to extend testing.</p>
<blockquote>
<table>
<colgroup>
<col style="width: 32%" />
<col style="width: 7%" />
<col style="width: 8%" />
<col style="width: 15%" />
<col style="width: 8%" />
<col style="width: 8%" />
<col style="width: 10%" />
<col style="width: 7%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr><th class="head"><p>Implementation</p></th>
<th class="head"><p>v7</p></th>
<th class="head"><p>ustar</p></th>
<th class="head"><p>pre-ustar</p></th>
<th class="head"><p>pax</p></th>
<th class="head"><p>GNU</p></th>
<th class="head"><p>GNU -G</p></th>
<th class="head"><p>star</p></th>
<th class="head"><p>sun</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>GNU tar</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
</tr>
<tr><td><p>libarchive</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
</tr>
<tr><td><p>star</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
</tr>
<tr><td><p>NetBSD pax</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>P</p></td>
<td><p>✓</p></td>
<td><p>T</p></td>
<td><p>✓</p></td>
<td><p>P</p></td>
</tr>
<tr><td><p>busybox</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>T</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
</tr>
<tr><td><p>Python</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>T</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
</tr>
<tr><td><p>p7zip</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>P</p></td>
<td><p>✓</p></td>
<td><p>T</p></td>
<td><p>✓</p></td>
<td><p>P</p></td>
</tr>
<tr><td><p>7-Zip</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>W</p></td>
<td><p>✓</p></td>
<td><p>T</p></td>
<td><p>✓</p></td>
<td><p>P</p></td>
</tr>
<tr><td><p>WinRAR</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>P</p></td>
</tr>
</tbody>
</table>
<p>✓: archive extracted correctly</p>
<p>✗: file rejected as invalid</p>
<p>P: file extracted correctly, pax headers extracted as files</p>
<p>T: timestamp incorrectly interpreted as path prefix</p>
<p>W: file extracted correctly, prints opaque header error warning</p>
</blockquote>
<p>The conclusion is that all the tested implementations handle all common
tar formats well.  The more complete GNU format with additional
timestamps confuses many tools; however, they are not used by default
by GNU tar.  The star format is accepted by most interpretations (taken
as v7 tar); only busybox explicitly rejects it.</p>
<p>The pax format causes extended headers to be extracted
as files by a few implementations.</p>
</section>
<section id="long-pathnames">
<h3><a class="toc-backref" href="#id18">Long pathnames</a></h3>
<p>The v7 tar format stores pathnames in a fixed field 100 octets long.
Since the string is null-terminated, this sets maximum filepath length
at 99 octets.  Newer tar formats support long pathnames in different
ways.</p>
<p>The ustar format introduces additional 155-octet prefix field
in the header.  If the path is longer than 99 octets, it can be split
at a path component boundary, and the 'prefix path' can be moved into
this field.  This gives a maximum path of up to 254 octets but the exact
limitations depend on the actual possibility of splitting on path
component.  Implementations not supporting the ustar format would
extract such file with partial (‘suffix’) path.</p>
<p>The pax format uses <span class="docutils literal">path</span> extended attribute to store long paths.
Therefore, the maximum path length is limited only by extended attribute
member length.  Non-compliant implementations will extract the file
using short name stored in the file member (the value is
implementation-defined) and possibly extract the extended attributes for
user's inspection.</p>
<p>The GNU format uses additional <span class="docutils literal">L</span> member preceding the file to store
the long path.  The maximum path length is limited only by maximum
member size.  Non-compliant implementations will extract the file using
short name stored in the regular file member and may extract the long
name as additional file.</p>
<p>The star format uses a prefix field similarly to ustar, and at the same
offset.  However, incompatibility may arise from the format lacking
ustar magic.  The xstar and newer formats are ustar-compatible.</p>
<blockquote>
<table>
<colgroup>
<col style="width: 49%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
</colgroup>
<thead>
<tr><th class="head"><p>Implementation</p></th>
<th class="head"><p>ustar</p></th>
<th class="head"><p>pax</p></th>
<th class="head"><p>GNU</p></th>
<th class="head"><p>star</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>GNU tar</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
</tr>
<tr><td><p>libarchive</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
</tr>
<tr><td><p>star</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
</tr>
<tr><td><p>NetBSD pax</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
</tr>
<tr><td><p>busybox</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
</tr>
<tr><td><p>Python</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
</tr>
<tr><td><p>p7zip</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
</tr>
<tr><td><p>7-Zip</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
</tr>
<tr><td><p>WinRAR</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
</tr>
</tbody>
</table>
<p>✓: file extracted correctly</p>
<p>✗: file extracted using partial path</p>
</blockquote>
<p>All tested implementations support ustar and GNU formats for long paths.
With the higher length limit, this makes the GNU format a clear winner.
The pax format metadata is extracted to text files by the other
implementations, making some degree of manual recovery possible.
The star format long paths are supported only by the original
implementation and Python tarfile module.</p>
</section>
<section id="large-file-sizes">
<h3><a class="toc-backref" href="#id19">Large file sizes</a></h3>
<p>The v7 format stores file size as octal number in a 12-octet field.
The strict format uses 11 octets, with the 12th being a terminator.
This results in a maximum file size of 8 GiB.</p>
<p>More lenient implementations allow for skipping the terminator, using
12 octal digits.  This increases the limit to 64 GiB.</p>
<p>Furthermore, some implementations (including GNU tar) allow for storing
the file sizes in binary (base-256) rather than octal form.  This is
signalled by setting the MSB of the first octet, and provides for 95-bit
integer size, i.e. 32768 YiB (it's so big that we lack a better prefix
for it).</p>
<p>Finally, the pax standard unsurprisingly provides a <span class="docutils literal">size</span> extended
attribute that can be used to specify file sizes as decimal number
of any length.  It might be useful if you ever need to store more than
32768 YiB.</p>
<blockquote>
<table>
<colgroup>
<col style="width: 48%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 13%" />
</colgroup>
<thead>
<tr><th class="head"><p>Implementation</p></th>
<th class="head"><p>12-digit</p></th>
<th class="head"><p>base-256</p></th>
<th class="head"><p>pax</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>GNU tar</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
</tr>
<tr><td><p>libarchive</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
</tr>
<tr><td><p>star</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
</tr>
<tr><td><p>NetBSD pax</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
</tr>
<tr><td><p>busybox</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
</tr>
<tr><td><p>Python</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
</tr>
<tr><td><p>p7zip</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
</tr>
<tr><td><p>7-Zip</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
</tr>
<tr><td><p>WinRAR</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
</tr>
</tbody>
</table>
<p>✓: file extracted correctly</p>
<p>✗: file truncated, rest of archive misinterpreted</p>
</blockquote>
<p>Out of three ways to indicate large file sizes, 12-digit storage
and base-256 encoding are supported by all but one tools.  However,
the 12-digit variant is not supported for writing GNU tar, libarchive
(where it is technically supported but hard-disabled in code) or star
which all switch to base-256 automatically.  Therefore, base-256 format
is more portable (and has much higher limit), though archives created
by it will not work on NetBSD at the moment.</p>
<p>Given that the correct read of the remainder of the archive depends
on correctly determining the data block size, unsupported large size
effectively makes the archive unusable.  The pax format may result
in the correct size being written to a text file but the user has
no trivial recovery means.</p>
</section>
<section id="user-and-group-information">
<h3><a class="toc-backref" href="#id20">User and group information</a></h3>
<p>In the v7 format, file ownership information is stored as numeric user
and group identifiers.  They are stored as 8-octet fields, therefore
being limited to 7 octal digits (which are equivalent to 21-bit
integer).  While the maximum number is not likely to be a problem,
using numeric identifiers rather than names does introduce problems
when different systems use different user/group mappings.</p>
<p>Similarly to file size field, some implementations permit using all
8 octets for octal numbers, or base-256 encoding (however, this is less
common than for file sizes).  Those practices can be used to extend
numeric identifiers to 24-bit and 63-bit integers respectively.</p>
<p>The ustar and GNU tar formats add username and group name fields that
are 32-octet long (31 characters + null terminator).</p>
<p>The star format also uses username and group name fields, except they're
located at different offsets and are 16-octet long.  The format is only
understood by star itself, and therefore was not included in the table.</p>
<p>Finally, the pax format provides extended attribute keys for both
user and group numeric identifiers (stored in decimal) and names.  This
extension effectively removes the forementioned limitations.</p>
<blockquote>
<table>
<colgroup>
<col style="width: 37%" />
<col style="width: 13%" />
<col style="width: 15%" />
<col style="width: 10%" />
<col style="width: 15%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr><th class="head"><p>Tested feature</p></th>
<th class="head" colspan="3"><p>Large numeric UID/GID</p></th>
<th class="head" colspan="2"><p>Long names</p></th>
</tr>
<tr><th class="head"><p>Implementation</p></th>
<th class="head"><p>8-digit</p></th>
<th class="head"><p>base-256</p></th>
<th class="head"><p>pax</p></th>
<th class="head"><p>32-octet</p></th>
<th class="head"><p>pax</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>GNU tar</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>C</p></td>
<td><p>✓</p></td>
</tr>
<tr><td><p>libarchive</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
</tr>
<tr><td><p>star</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
</tr>
<tr><td><p>NetBSD pax</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
</tr>
<tr><td><p>busybox</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
</tr>
<tr><td><p>Python</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
</tr>
<tr><td><p>p7zip</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
</tr>
</tbody>
</table>
<p>✓: user/group interpreted correctly</p>
<p>✗: user/group information ignored</p>
<p>C: user/group name concatenated with the field following it</p>
</blockquote>
<p>The support for large numeric user and group identifiers is mostly
consistent with support for large sizes, with the notable exception
of star and p7zip not supporting base-256 encoding on these fields.
The 8-octet variant is not used by common tools, making base-256 and pax
two commonly possible choices.  Choosing the former loses star support,
the latter busybox tar support.</p>
<p>32-octet long user and group names are supported by most
of the implementations.  The notable exception is GNU tar that
as of v1.30 relies on the null terminator being present and concatenates
the values with the fields following them when it's not.  GNU tar also
truncates the name at 31 octets when writing the archive.</p>
<p>Windows implementations were skipped from the test since they do not
seem to provide access to user/group information (7-Zip technical list
mode provides user/group names but it's no different from p7zip).</p>
</section>
<section id="timestamps">
<h3><a class="toc-backref" href="#id21">Timestamps</a></h3>
<p>Out of timestamps, the v7 format provides only for storing mtime.  It is
stored in 12-octet field, permitting 11 octal digits which
are sufficient for 33-bit timestamps.</p>
<p>The documentation suggests that historically negative octal numbers
might have been used for timestamps.  However, none of the tested
implementations seem to support that.</p>
<p>Again, some implementations permit using 12 octal digits and/or base-256
encoding.  The former provides for 36 bits of data, the latter
for 95-bit signed integer.</p>
<p>The GNU tar format provides additional fields for atime and ctime.
However, it seems that modern versions of GNU tar do not use them
by default.  They need to be enabled explicitly via <span class="docutils literal"><span class="pre">-G</span></span> option,
and they confuse some archivers (see <a class="reference internal" href="#tar-format-acceptance">tar format acceptance</a>).</p>
<p>The star format provides octal atime and ctime fields as well,
at different offsets than GNU tar.  They are only supported
by the original implementation.</p>
<p>Finally, the pax format provides <span class="docutils literal">atime</span>, <span class="docutils literal">ctime</span> and <span class="docutils literal">mtime</span>
extended attributes that are stored as decimal floating-point numbers.
Therefore, they provide both unlimited range and precision.</p>
<blockquote>
<table>
<colgroup>
<col style="width: 31%" />
<col style="width: 13%" />
<col style="width: 8%" />
<col style="width: 8%" />
<col style="width: 13%" />
<col style="width: 8%" />
<col style="width: 10%" />
<col style="width: 8%" />
</colgroup>
<thead>
<tr><th class="head"><p>Tested feature</p></th>
<th class="head" colspan="3"><p>Large positive mtime</p></th>
<th class="head" colspan="2"><p>Negative mtime</p></th>
<th class="head" colspan="2"><p>atime, ctime</p></th>
</tr>
<tr><th class="head"><p>Implementation</p></th>
<th class="head"><p>12-digit</p></th>
<th class="head"><p>b-256</p></th>
<th class="head"><p>pax</p></th>
<th class="head"><p>base-256</p></th>
<th class="head"><p>pax</p></th>
<th class="head"><p>GNU -G</p></th>
<th class="head"><p>pax</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>GNU tar</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
</tr>
<tr><td><p>libarchive</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
</tr>
<tr><td><p>star</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
</tr>
<tr><td><p>NetBSD pax</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
</tr>
<tr><td><p>busybox</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
</tr>
<tr><td><p>Python</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
</tr>
<tr><td><p>p7zip</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
</tr>
<tr><td><p>7-Zip</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
</tr>
<tr><td><p>WinRAR</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
</tr>
</tbody>
</table>
<p>✓: timestamp interpreted correctly</p>
<p>✗: timestamp misinterpreted or ignored</p>
</blockquote>
<p>The support for large positive mtimes formatted as 12-digit octal
vs base-256 seems to be equal.  However, similarly to the previous cases
the 12-digit format is not written out of the box and requires manual
code hacking, making base-256 the winner.</p>
<p>The support for negative mtimes provided by base-256 and pax format
is largely equal to the support for the formats themselves.  One notable
exception is p7zip that does not seem to interpret negative mtimes
as of 16.02.  It is possible that updating it to match 7-Zip current
would solve that.</p>
<p>As a curiosity, star seems to use large octal mtime values to indicate
negative mtimes, making it incompatible with the other implementations.</p>
<p>The support for atime and ctime seems to be very limited.  The tests
were based on restoring atimes, given that ctime can not be forced.
Of the tested implementations, only GNU tar, libarchive bsdtar and star
restored atimes.  Surprisingly, GNU tar could not be forced to restore
atime from GNU format archive.  It also required explicit <span class="docutils literal"><span class="pre">-G</span></span> option
to restore it from the pax format.</p>
<p>Python tarfile, p7zip and Windows archivers do not provide any way
to obtain atime or ctime (other than reading raw pax attributes).</p>
</section>
<section id="extended-file-metadata">
<h3><a class="toc-backref" href="#id22">Extended file metadata</a></h3>
<section id="acls">
<h4><a class="toc-backref" href="#id23">ACLs</a></h4>
<p>The pax format permits storing file ACLs in the <span class="docutils literal">SCHILY.acl.*</span> family
of attributes.  While the entries have apparent star origins, they seem
to have become the de facto standard for ACLs.</p>
<p>According to tar(5), the Solaris and AIX tar formats provide explicit
entry type for ACL storage, and MacOS tar uses additional binary blob
for extended attributes.  Neither of those formats seem to be supported
by GNU tar, libarchive or star, so they are not tested here.</p>
</section>
<section id="file-flags">
<h4><a class="toc-backref" href="#id24">File flags</a></h4>
<p>Extended file flags (e.g. used by chflags(1) on BSD or lsattr(1)
and chattr(1) on Linux) can be stored in the <span class="docutils literal">SCHILY.fflags</span> field.
However, support for this standard seems to be rather limited.
Furthermore, different implementations seem to be using different flag
names.</p>
</section>
<section id="generic-extended-attributes">
<h4><a class="toc-backref" href="#id25">Generic extended attributes</a></h4>
<p>Generic extended attributes (xattr) are stored in pax archives in two
notations: <span class="docutils literal">SCHILY.xattr.*</span> notation encoding attribute values inline
and <span class="docutils literal">LIBARCHIVE.xattr.*</span> notation using base64 encoding of values.
GNU tar and star are using the former, while libarchive is using both
by default.</p>
</section>
<section id="attribute-support-test">
<h4><a class="toc-backref" href="#id26">Attribute support test</a></h4>
<blockquote>
<table>
<colgroup>
<col style="width: 40%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 21%" />
</colgroup>
<thead>
<tr><th class="head"><p>Feature</p></th>
<th class="head"><p>ACL</p></th>
<th class="head"><p>fflags</p></th>
<th class="head" colspan="2"><p>generic xattr</p></th>
</tr>
<tr><th class="head"><p>Implementation</p></th>
<th class="head"><p>SCHILY</p></th>
<th class="head"><p>SCHILY</p></th>
<th class="head"><p>SCHILY</p></th>
<th class="head"><p>LIBARCHIVE</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>GNU tar</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
</tr>
<tr><td><p>libarchive</p></td>
<td><p>✓</p></td>
<td><p>✓#</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
</tr>
<tr><td><p>star</p></td>
<td><p>✓</p></td>
<td><p>✓#</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
</tr>
<tr><td><p>NetBSD pax</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
</tr>
<tr><td><p>busybox</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
</tr>
<tr><td><p>Python</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
</tr>
<tr><td><p>p7zip</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
</tr>
</tbody>
</table>
<p>✓: extended attributes supported</p>
<p>#: attribute only partially compatible</p>
<p>✗: extended attributes ignored</p>
</blockquote>
<p>The support for extended file attributes is limited to GNU tar,
libarchive and star.  ACLs and generic xattrs are supported consistently
by all three of them.  File flags are supported only by libarchive
and star, and since the flag names they use only partially overlap,
archives are not fully compatible.</p>
<p>libarchive supports an additional base64-encoded variant of xattrs.
However, no other implementations seems to support it and libarchive
additionally stores more widely supported <span class="docutils literal">SCHILY.*</span> variant for
compatibility.</p>
</section>
</section>
<section id="sparse-files">
<h3><a class="toc-backref" href="#id27">Sparse files</a></h3>
<p>The support for archiving sparse files is entirely non-standarized.
In regular tar archives, the sparse areas are filled up with zeros.</p>
<p>The GNU tar format provides support for sparse fragments in custom
extension fields.  Up to 4 fragments can be stored within regular header
size; if more are necessary, additional blocks with fragment information
are appended after the header.</p>
<p>The newer GNU tar versions also three different (all GNU-custom) formats
for sparse files in the pax format.  They are called <span class="docutils literal">0.0</span>, <span class="docutils literal">0.1</span>
and <span class="docutils literal">1.0</span> formats respectively.</p>
<p>For completeness, the tests also cover custom sparse file support
in the star and xstar formats.  The latter is partially compatible
with the extended header format used by GNU tar.</p>
<blockquote>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 7%" />
<col style="width: 9%" />
<col style="width: 18%" />
</colgroup>
<thead>
<tr><th class="head"><p>Variant group</p></th>
<th class="head" colspan="2"><p>GNU tar</p></th>
<th class="head" colspan="3"><p>pax (GNU.*)</p></th>
<th class="head" colspan="2"><p>star</p></th>
<th class="head"><p>Extracted</p></th>
</tr>
<tr><th class="head"><p>Implementation</p></th>
<th class="head"><p>small</p></th>
<th class="head"><p>large</p></th>
<th class="head"><p>0.0</p></th>
<th class="head"><p>0.1</p></th>
<th class="head"><p>1.0</p></th>
<th class="head"><p>star</p></th>
<th class="head"><p>xstar</p></th>
<th class="head"><p>as sparse?</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>GNU tar</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
</tr>
<tr><td><p>libarchive</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
</tr>
<tr><td><p>star</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
</tr>
<tr><td><p>NetBSD pax</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>n/a</p></td>
</tr>
<tr><td><p>busybox</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>n/a</p></td>
</tr>
<tr><td><p>Python</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
</tr>
<tr><td><p>p7zip</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
</tr>
<tr><td><p>7-Zip</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>n/a</p></td>
</tr>
<tr><td><p>WinRAR</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>n/a</p></td>
</tr>
</tbody>
</table>
<p>✓: file extracted correctly</p>
<p>✗: file extracted incorrectly or archive rejected</p>
</blockquote>
<p>Sparse files are supported only by a few implementations.  The most
widely supported format is the old GNU format.  The GNU pax extensions
are supported only by GNU tar, libarchive and Python tarfile module.
p7zip supports archives with GNU format sparse files but extracts them
as regular (zero-padded) files.</p>
<p>The star format is supported only by the initial implementation.
The xstar formats maintains some binary compatibility with the old GNU
format, and works with GNU tar.  However, other implementations
supporting the GNU tar format do not seem that lenient.</p>
</section>
<section id="volume-label">
<h3><a class="toc-backref" href="#id28">Volume label</a></h3>
<p>The volume label is a GNU tar extension.  It is supported in GNU tar,
star and pax formats.</p>
<p>In GNU tar and star formats, the volume label is added as a special
<span class="docutils literal">V</span> type member.  Technically, this means that non-GNU implementations
should extract it as a regular file according to the POSIX ustar
specification on handling unknown vendor types.</p>
<p>In pax format, the volume label is written as <span class="docutils literal">GNU.volume.label</span>
global attribute.</p>
<blockquote>
<table>
<colgroup>
<col style="width: 30%" />
<col style="width: 8%" />
<col style="width: 8%" />
<col style="width: 8%" />
<col style="width: 47%" />
</colgroup>
<thead>
<tr><th class="head"><p>Implementation</p></th>
<th class="head"><p>GNU</p></th>
<th class="head"><p>pax</p></th>
<th class="head"><p>star</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>GNU tar</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>included in <span class="docutils literal"><span class="pre">-t</span></span>/<span class="docutils literal"><span class="pre">-v</span></span></p></td>
</tr>
<tr><td><p>libarchive</p></td>
<td><p>✓</p></td>
<td><p>I</p></td>
<td><p>✓</p></td>
<td></td>
</tr>
<tr><td><p>star</p></td>
<td><p>W</p></td>
<td><p>I</p></td>
<td><p>I</p></td>
<td></td>
</tr>
<tr><td><p>NetBSD pax</p></td>
<td><p>W+F</p></td>
<td><p>P</p></td>
<td><p>F</p></td>
<td></td>
</tr>
<tr><td><p>busybox</p></td>
<td><p>✗</p></td>
<td><p>I</p></td>
<td><p>✗</p></td>
<td></td>
</tr>
<tr><td><p>Python</p></td>
<td><p>F</p></td>
<td><p>I</p></td>
<td><p>F</p></td>
<td></td>
</tr>
<tr><td><p>p7zip</p></td>
<td><p>✗</p></td>
<td><p>P</p></td>
<td><p>F</p></td>
<td></td>
</tr>
<tr><td><p>7-Zip</p></td>
<td><p>✗</p></td>
<td><p>P</p></td>
<td><p>F</p></td>
<td></td>
</tr>
<tr><td><p>WinRAR</p></td>
<td><p>F</p></td>
<td><p>I?</p></td>
<td><p>F</p></td>
<td><p>proprietary; can't verify pax</p></td>
</tr>
</tbody>
</table>
<p>✓: file extracted correctly</p>
<p>W: file extracted correctly, warning about file format</p>
<p>I: file extracted correctly, attribute explicitly ignored</p>
<p>F: label extracted as regular (empty) file with mode 0000</p>
<p>P: file extracted correctly, pax headers extracted as files</p>
<p>✗: file rejected as malformed</p>
</blockquote>
<p>The GNU volume label feature suffers serious portability problems.  Only
GNU tar and libarchive provide explicit support for it.  Its presence
in the GNU format causes multiple archivers to reject the archive
altogether.  The exact behavior of pax format is hard to determine since
the label is normally not extracted; the I/P flags determined
by examining the source code.</p>
</section>
<section id="multi-volume-archives">
<h3><a class="toc-backref" href="#id29">Multi-volume archives</a></h3>
<p>GNU tar and star support creating multi-volume archives.  However,
the multi-volume format is mostly intended for tape drives, and is
inconvenient (requiring manually typing filenames) for regular files.
With files, using split(1) is a better idea.</p>
<p>GNU tar can create multi-volume archives either with GNU tar or pax
file format.  The former is simpler, and uses special <span class="docutils literal">M</span> member type
to indicate continuation of file from previous volume.  The latter uses
<span class="docutils literal">GNU.volume.*</span> pax attributes to store continuation info, storing
the continued member as regular file.  This makes it possible for
non-compliant implementations to extract file in parts for concatenation
by user.</p>
<p>star can create multi-volume archives in xstar, xustar and exustar
formats.  All those formats use <span class="docutils literal">M</span> member type similarly to GNU tar,
plus additional <span class="docutils literal">V</span> volume label in the first archive.  The xustar
format adds more continuation information to the second archive using
<span class="docutils literal">SCHILY.*</span> pax attributes.  The exustar format additionally adds
volume information to all volumes using <span class="docutils literal">SCHILY.*</span> global pax
attributes.</p>
<blockquote>
<table>
<colgroup>
<col style="width: 40%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 13%" />
<col style="width: 15%" />
</colgroup>
<thead>
<tr><th class="head"><p>Variant group</p></th>
<th class="head" colspan="2"><p>GNU tar</p></th>
<th class="head" colspan="3"><p>star</p></th>
</tr>
<tr><th class="head"><p>Implementation</p></th>
<th class="head"><p>GNU</p></th>
<th class="head"><p>pax</p></th>
<th class="head"><p>xstar</p></th>
<th class="head"><p>xustar</p></th>
<th class="head"><p>exustar</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>GNU tar</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr><td><p>libarchive</p></td>
<td><p>Z</p></td>
<td><p>Z</p></td>
<td><p>Z</p></td>
<td><p>Z</p></td>
<td><p>Z</p></td>
</tr>
<tr><td><p>star</p></td>
<td><p>✓</p></td>
<td><p>W</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
</tr>
<tr><td><p>NetBSD pax</p></td>
<td><p>M</p></td>
<td><p>M+P</p></td>
<td><p>M+F</p></td>
<td><p>M+F</p></td>
<td><p>M+F+P</p></td>
</tr>
<tr><td><p>busybox</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
</tr>
<tr><td><p>Python</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
</tr>
<tr><td><p>p7zip</p></td>
<td><p>1</p></td>
<td><p>1+P</p></td>
<td><p>1+F</p></td>
<td><p>1+F</p></td>
<td><p>1+F+P</p></td>
</tr>
<tr><td><p>7-Zip</p></td>
<td><p>1</p></td>
<td><p>1+P</p></td>
<td><p>1+F</p></td>
<td><p>1+F</p></td>
<td><p>1+F+P</p></td>
</tr>
<tr><td><p>WinRAR</p></td>
<td><p>T</p></td>
<td><p>T</p></td>
<td><p>T+F</p></td>
<td><p>T+F</p></td>
<td><p>T+F</p></td>
</tr>
</tbody>
</table>
<p>✓: file extracted correctly</p>
<p>W: file extracted correctly, warning about unknown pax attrs</p>
<p>1: only first part extracted, continuation archive rejected</p>
<p>Z: only first part extracted, file zero-padded to full size</p>
<p>P: pax headers extracted as files</p>
<p>F: extra data extracted as file</p>
<p>M: continuation archive misread (output malformed)</p>
<p>T: first part extracted only partially (interrupted by error)</p>
<p>✗: archive rejected</p>
</blockquote>
<p>As expected, the support for multi-volume archives is poor.  GNU tar
can only extract its own multi-volume format; star can extract both GNU
and its own format.  All other tools error out either on truncated file
or invalid format (especially in case of star formats).</p>
<p>In some cases, the tools can extract parts of the file from both
archives separately, making it possible to manually reconstruct it.
However, e.g. libarchive pads the file to full size (preallocates?),
and WinRAR apparently does not flush output when erroring out.
Furthermore, some tools reject the second and further volumes (e.g. GNU
tar on star formats).</p>
<p>Curious enough, the NetBSD pax tool seems to support split(1)-made
multi-volume archives explicitly (i.e. request further volumes).</p>
</section>
<section id="feature-matrix">
<h3><a class="toc-backref" href="#id30">Feature matrix</a></h3>
<p>The following table summarizes the support for most useful formats
and their features.  Some of the earlier results are skipped because
of their unlikely usefulness, e.g. long octet fields since no common
implementation writes them.</p>
<p>Please note that the table is focused on rough usefulness and not
the details.  For example, since volume label has no real implications,
it is considered ✓ as long as the archive is accepted; but some pax
attributes are considered ✓ only if the relevant property is actually
restored.</p>
<blockquote>
<table>
<colgroup>
<col style="width: 45%" />
<col style="width: 2%" />
<col style="width: 2%" />
<col style="width: 2%" />
<col style="width: 2%" />
<col style="width: 2%" />
<col style="width: 2%" />
<col style="width: 2%" />
<col style="width: 2%" />
<col style="width: 2%" />
<col style="width: 2%" />
<col style="width: 2%" />
<col style="width: 2%" />
<col style="width: 2%" />
<col style="width: 2%" />
<col style="width: 2%" />
<col style="width: 2%" />
<col style="width: 2%" />
<col style="width: 2%" />
<col style="width: 2%" />
<col style="width: 2%" />
<col style="width: 2%" />
<col style="width: 2%" />
<col style="width: 2%" />
</colgroup>
<thead>
<tr><th class="head"><p>Format</p></th>
<th class="head" colspan="9"><p>GNU + base-256</p></th>
<th class="head" colspan="14"><p>pax</p></th>
</tr>
<tr><th class="head"><p>Implementation</p></th>
<th class="head"><p>p</p></th>
<th class="head"><p>s</p></th>
<th class="head"><p>u</p></th>
<th class="head"><p>m</p></th>
<th class="head"><p>n</p></th>
<th class="head"><p>r</p></th>
<th class="head"><p>l</p></th>
<th class="head"><p>y</p></th>
<th class="head"><p>v</p></th>
<th class="head"><p>p</p></th>
<th class="head"><p>s</p></th>
<th class="head"><p>u</p></th>
<th class="head"><p>g</p></th>
<th class="head"><p>m</p></th>
<th class="head"><p>n</p></th>
<th class="head"><p>t</p></th>
<th class="head"><p>a</p></th>
<th class="head"><p>f</p></th>
<th class="head"><p>x</p></th>
<th class="head"><p>r</p></th>
<th class="head"><p>l</p></th>
<th class="head"><p>v</p></th>
<th class="head"><p>y</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>GNU tar</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
</tr>
<tr><td><p>libarchive</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
</tr>
<tr><td><p>star</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
</tr>
<tr><td><p>NetBSD pax</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
</tr>
<tr><td><p>busybox</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
</tr>
<tr><td><p>Python</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
</tr>
<tr><td><p>p7zip</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
</tr>
<tr><td><p>7-Zip</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td></td>
<td></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td></td>
<td></td>
<td></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
</tr>
<tr><td><p>WinRAR</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td></td>
<td></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td></td>
<td></td>
<td></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
</tr>
</tbody>
</table>
<p>p: long paths</p>
<p>s: extended size range</p>
<p>u: extended UID/GID range</p>
<p>g: extended user/group names</p>
<p>m: extended mtime range</p>
<p>n: negative mtime</p>
<p>t: extended timestamps (atime, ctime)</p>
<p>a: ACLs</p>
<p>f: file flags</p>
<p>x: extended attributes</p>
<p>r: sparse files</p>
<p>l: volume label</p>
<p>y: (GNU tar) does not create stray file for label</p>
<p>v: multi-volume archives</p>
<p>y: (pax) does not create stray files for pax attributes</p>
</blockquote>
</section>
</section>
<section id="summary">
<h2><a class="toc-backref" href="#id31">Summary</a></h2>
<p>The ustar format (both in POSIX and pre-POSIX/GNU variant) is widely
supported.  Only few of the tested implementations can distinguish
pre-POSIX ustar archives from GNU archives; modern versions of GNU tar
avoid writing atime/ctime that confuses ustar-based archivers.</p>
<p>The support for pax format is surprisingly weak.  Many archivers extract
pax attributes as regular files without interpreting even the most basic
set.  Some implementations try to combine pax and GNU format extensions
whenever possible to improve compatibility.</p>
<p>Out of the tested implementations, GNU tar, libarchive and star seem
to be state-of-the-art archivers.  The Python tarfile module also
implements a wide range of formats.  BusyBox and 7-Zip seem to have
relatively good support for GNU extensions but not pax.</p>
<p>The best compatibility advise is to use the POSIX ustar format and avoid
any extensions whenever possible.  If long paths are necessary, both
the ustar and the GNU formats are good choices (the latter especially
if the ustar limit is too small).  For files over 8 GiB of size, the GNU
format seems to be the best choice (though it defeats NetBSD pax
already).</p>
<p>Other extended features are going to cause more trouble.  Wider ranges
of user/group information and timestamps are supported unevenly both
in GNU and pax formats.  Technically, the choice of pax there is safer;
however, all the tested implementations simply ignored base-256 values
they could not interpret.  For numeric values, combining pax
and base-256 encodings may improve portability.</p>
<p>Additional timestamps (atime, ctime), ACLs, file flags and extended
attributes require the use of pax format.  They are only supported
by GNU tar, libarchive and star.  File flags are limited to libarchive
and star, with both implementations being only partially compatible.</p>
<p>Sparse files are supported by most of the implementations in GNU format,
and by a few less in pax format (all three versions of GNU extension
having the same level of support).  For portability, it's best to avoid
using this feature and instead store the files zero-padded and rely
on compression and automatic hole detection.</p>
<p>Volume labels are best avoided in the GNU format as they cause a few
tools to reject the archives altogether.  They are entirely safe
in the pax format (if you ignore the usual problem of stray files).</p>
<p>Multi-volume archives are barely supported and inconvenient to use.
If there is a necessity of splitting the archive, use of split(1) is
strongly preferable.</p>
<p>To summarize, if your main concern are long paths and/or large files,
the GNU format is the best choice.  Extended file metadata may require
using the pax format (possibly combined with base-256 whenever
possible); however, using it reduces compatibility with long paths
and may cause extraneous files to be created.  Volume label can be used
safely if pax format is already used.  All other features should be
avoided.</p>
<p>Judging by the test results, the most portability could be achieved by:</p>
<ul class="simple">
<li><p>using strict POSIX ustar format whenever possible,</p></li>
<li><p>using GNU format for long paths (that do not fit in ustar format),</p></li>
<li><p>using base-256 (+ pax if already used) encoding for large files,</p></li>
<li><p>using pax (+ octal or base-256) for high-range/precision timestamps
and user/group identifiers,</p></li>
<li><p>using pax attributes for extended metadata and/or volume label.</p></li>
</ul>
<p>However, whether such a profile could be reliably used would require
further testing, e.g. for interoperability between pax headers
and GNU-style long paths.</p>
</section>
<section id="references">
<h2><a class="toc-backref" href="#id32">References</a></h2>
<dl class="footnote brackets">
<dt class="label" id="gnutar"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>GNU Tar
(<a class="reference external" href="https://www.gnu.org/software/tar/">https://www.gnu.org/software/tar/</a>)</p>
</dd>
<dt class="label" id="libarchive"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>libarchive
(<a class="reference external" href="http://www.libarchive.org/">http://www.libarchive.org/</a>)</p>
</dd>
<dt class="label" id="star"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>star
(<a class="reference external" href="https://sourceforge.net/projects/s-tar/">https://sourceforge.net/projects/s-tar/</a>)</p>
</dd>
<dt class="label" id="netbsd-pax"><span class="brackets"><a class="fn-backref" href="#id4">4</a></span></dt>
<dd><p>NetBSD CVS: src/bin/pax/
(<a class="reference external" href="http://cvsweb.netbsd.org/bsdweb.cgi/src/bin/pax/">http://cvsweb.netbsd.org/bsdweb.cgi/src/bin/pax/</a>)</p>
</dd>
<dt class="label" id="busybox"><span class="brackets"><a class="fn-backref" href="#id5">5</a></span></dt>
<dd><p>BusyBox
(<a class="reference external" href="https://www.busybox.net">https://www.busybox.net</a>)</p>
</dd>
<dt class="label" id="python-tarfile"><span class="brackets"><a class="fn-backref" href="#id6">6</a></span></dt>
<dd><p>Python 3.7: tarfile
(<a class="reference external" href="https://docs.python.org/3.7/library/tarfile.html">https://docs.python.org/3.7/library/tarfile.html</a>)</p>
</dd>
<dt class="label" id="p7zip"><span class="brackets"><a class="fn-backref" href="#id7">7</a></span></dt>
<dd><p>P7ZIP
(<a class="reference external" href="http://p7zip.sourceforge.net/">http://p7zip.sourceforge.net/</a>)</p>
</dd>
<dt class="label" id="zip"><span class="brackets"><a class="fn-backref" href="#id8">8</a></span></dt>
<dd><p>7-Zip
(<a class="reference external" href="https://www.7-zip.org/">https://www.7-zip.org/</a>)</p>
</dd>
<dt class="label" id="winrar"><span class="brackets"><a class="fn-backref" href="#id9">9</a></span></dt>
<dd><p>WinRAR
(<a class="reference external" href="https://rarlab.com/">https://rarlab.com/</a>)</p>
</dd>
<dt class="label" id="tar-test-inputs"><span class="brackets"><a class="fn-backref" href="#id10">10</a></span></dt>
<dd><p>Test inputs for tar implementation compatibility
check
(<a class="reference external" href="https://github.com/mgorny/tar-test-inputs">https://github.com/mgorny/tar-test-inputs</a>)</p>
</dd>
<dt class="label" id="tar-5"><span class="brackets"><a class="fn-backref" href="#id11">11</a></span></dt>
<dd><p>tar(5) manual page
(<a class="reference external" href="https://github.com/libarchive/libarchive/wiki/ManPageTar5">https://github.com/libarchive/libarchive/wiki/ManPageTar5</a>)</p>
</dd>
</dl>
</section>
</main>
</body>
</html>
